<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#001a33">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="MN90Mobile">
    <title>ü§ø MN90Mobile - 364 LIGNES</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        let currentTab = 0, chart1 = null, isDraggingSplitter = false;
        let superposedView = false;
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
        
        function minToHHMM(minutes) {
            const h = Math.floor(minutes / 60);
            const m = minutes % 60;
            return `${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}`;
        }
        
        function minToHHMMSS(minutes) {
            const totalSeconds = Math.round(minutes * 60);
            const h = Math.floor(totalSeconds / 3600);
            const m = Math.floor((totalSeconds % 3600) / 60);
            const s = totalSeconds % 60;
            return `${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
        }

        const mn90Tables = [{prof:6,time:15,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'A'},{prof:6,time:30,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'B'},{prof:6,time:45,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'C'},{prof:6,time:75,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'D'},{prof:6,time:105,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'E'},{prof:6,time:135,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'F'},{prof:6,time:180,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'G'},{prof:6,time:240,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'H'},{prof:6,time:315,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'I'},{prof:6,time:360,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'J'},{prof:8,time:15,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'B'},{prof:8,time:30,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'C'},{prof:8,time:45,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'D'},{prof:8,time:60,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'E'},{prof:8,time:90,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'F'},{prof:8,time:105,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'G'},{prof:8,time:135,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'H'},{prof:8,time:165,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'I'},{prof:8,time:195,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'J'},{prof:8,time:255,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'K'},{prof:8,time:300,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'L'},{prof:8,time:360,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'M'},{prof:10,time:15,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'B'},{prof:10,time:30,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'C'},{prof:10,time:45,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'D'},{prof:10,time:60,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'F'},{prof:10,time:75,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'G'},{prof:10,time:105,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'H'},{prof:10,time:120,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'I'},{prof:10,time:135,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'J'},{prof:10,time:165,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'K'},{prof:10,time:180,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'L'},{prof:10,time:240,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'M'},{prof:10,time:255,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'N'},{prof:10,time:315,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'O'},{prof:10,time:330,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'P'},{prof:10,time:360,p15:0,p12:0,p9:0,p6:0,p3:1,dtr:2,gps:'P'},{prof:12,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'A'},{prof:12,time:10,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'B'},{prof:12,time:15,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'B'},{prof:12,time:20,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'C'},{prof:12,time:25,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'C'},{prof:12,time:30,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'D'},{prof:12,time:35,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'D'},{prof:12,time:40,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'E'},{prof:12,time:45,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'E'},{prof:12,time:50,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'F'},{prof:12,time:55,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'F'},{prof:12,time:60,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'G'},{prof:12,time:65,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'G'},{prof:12,time:70,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'H'},{prof:12,time:75,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'H'},{prof:12,time:80,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'H'},{prof:12,time:85,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'I'},{prof:12,time:90,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'I'},{prof:12,time:95,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'J'},{prof:12,time:100,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'J'},{prof:12,time:105,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'J'},{prof:12,time:110,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'K'},{prof:12,time:115,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'K'},{prof:12,time:120,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'K'},{prof:12,time:130,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'L'},{prof:12,time:135,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'L'},{prof:12,time:140,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:4,gps:'L'},{prof:12,time:150,p15:0,p12:0,p9:0,p6:0,p3:4,dtr:6,gps:'M'},{prof:12,time:160,p15:0,p12:0,p9:0,p6:0,p3:6,dtr:8,gps:'M'},{prof:12,time:170,p15:0,p12:0,p9:0,p6:0,p3:7,dtr:9,gps:'N'},{prof:12,time:180,p15:0,p12:0,p9:0,p6:0,p3:9,dtr:11,gps:'N'},{prof:12,time:190,p15:0,p12:0,p9:0,p6:0,p3:11,dtr:13,gps:'N'},{prof:12,time:200,p15:0,p12:0,p9:0,p6:0,p3:13,dtr:15,gps:'O'},{prof:12,time:210,p15:0,p12:0,p9:0,p6:0,p3:14,dtr:16,gps:'O'},{prof:12,time:220,p15:0,p12:0,p9:0,p6:0,p3:15,dtr:17,gps:'O'},{prof:12,time:230,p15:0,p12:0,p9:0,p6:0,p3:16,dtr:18,gps:'O'},{prof:12,time:240,p15:0,p12:0,p9:0,p6:0,p3:17,dtr:19,gps:'O'},{prof:12,time:250,p15:0,p12:0,p9:0,p6:0,p3:18,dtr:20,gps:'P'},{prof:12,time:255,p15:0,p12:0,p9:0,p6:0,p3:19,dtr:21,gps:'P'},{prof:12,time:270,p15:0,p12:0,p9:0,p6:0,p3:22,dtr:24,gps:'P'},{prof:15,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'A'},{prof:15,time:10,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'B'},{prof:15,time:15,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'C'},{prof:15,time:20,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'C'},{prof:15,time:25,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'D'},{prof:15,time:30,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'E'},{prof:15,time:35,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'E'},{prof:15,time:40,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'F'},{prof:15,time:45,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'G'},{prof:15,time:50,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'G'},{prof:15,time:55,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'H'},{prof:15,time:60,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'H'},{prof:15,time:65,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'I'},{prof:15,time:70,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'I'},{prof:15,time:75,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:1,gps:'J'},{prof:15,time:80,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:4,gps:'J'},{prof:15,time:85,p15:0,p12:0,p9:0,p6:0,p3:4,dtr:6,gps:'K'},{prof:15,time:90,p15:0,p12:0,p9:0,p6:0,p3:6,dtr:8,gps:'K'},{prof:15,time:95,p15:0,p12:0,p9:0,p6:0,p3:8,dtr:10,gps:'L'},{prof:15,time:100,p15:0,p12:0,p9:0,p6:0,p3:11,dtr:13,gps:'L'},{prof:15,time:105,p15:0,p12:0,p9:0,p6:0,p3:13,dtr:15,gps:'L'},{prof:15,time:110,p15:0,p12:0,p9:0,p6:0,p3:15,dtr:17,gps:'M'},{prof:15,time:115,p15:0,p12:0,p9:0,p6:0,p3:17,dtr:19,gps:'M'},{prof:15,time:120,p15:0,p12:0,p9:0,p6:0,p3:18,dtr:20,gps:'M'},{prof:18,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'B'},{prof:18,time:10,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'B'},{prof:18,time:15,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'C'},{prof:18,time:20,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'D'},{prof:18,time:25,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'E'},{prof:18,time:30,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'F'},{prof:18,time:35,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'F'},{prof:18,time:40,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'G'},{prof:18,time:45,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'H'},{prof:18,time:50,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'H'},{prof:18,time:55,p15:0,p12:0,p9:0,p6:0,p3:1,dtr:3,gps:'I'},{prof:18,time:60,p15:0,p12:0,p9:0,p6:0,p3:5,dtr:7,gps:'J'},{prof:18,time:65,p15:0,p12:0,p9:0,p6:0,p3:8,dtr:10,gps:'J'},{prof:18,time:70,p15:0,p12:0,p9:0,p6:0,p3:11,dtr:13,gps:'K'},{prof:18,time:75,p15:0,p12:0,p9:0,p6:0,p3:14,dtr:16,gps:'K'},{prof:18,time:80,p15:0,p12:0,p9:0,p6:0,p3:17,dtr:19,gps:'L'},{prof:18,time:85,p15:0,p12:0,p9:0,p6:0,p3:21,dtr:23,gps:'L'},{prof:18,time:90,p15:0,p12:0,p9:0,p6:0,p3:23,dtr:25,gps:'M'},{prof:18,time:95,p15:0,p12:0,p9:0,p6:0,p3:26,dtr:28,gps:'M'},{prof:18,time:100,p15:0,p12:0,p9:0,p6:0,p3:28,dtr:30,gps:'M'},{prof:18,time:105,p15:0,p12:0,p9:0,p6:0,p3:31,dtr:33,gps:'N'},{prof:18,time:110,p15:0,p12:0,p9:0,p6:0,p3:34,dtr:36,gps:'N'},{prof:18,time:115,p15:0,p12:0,p9:0,p6:0,p3:36,dtr:38,gps:'N'},{prof:18,time:120,p15:0,p12:0,p9:0,p6:0,p3:38,dtr:40,gps:'O'},{prof:20,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'B'},{prof:20,time:10,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'B'},{prof:20,time:15,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'D'},{prof:20,time:20,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'D'},{prof:20,time:25,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'E'},{prof:20,time:30,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'F'},{prof:20,time:35,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'G'},{prof:20,time:40,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'H'},{prof:20,time:45,p15:0,p12:0,p9:0,p6:0,p3:1,dtr:3,gps:'I'},{prof:20,time:50,p15:0,p12:0,p9:0,p6:0,p3:4,dtr:6,gps:'I'},{prof:20,time:55,p15:0,p12:0,p9:0,p6:0,p3:9,dtr:11,gps:'J'},{prof:20,time:60,p15:0,p12:0,p9:0,p6:0,p3:13,dtr:15,gps:'K'},{prof:20,time:65,p15:0,p12:0,p9:0,p6:0,p3:16,dtr:18,gps:'K'},{prof:20,time:70,p15:0,p12:0,p9:0,p6:0,p3:20,dtr:22,gps:'L'},{prof:20,time:75,p15:0,p12:0,p9:0,p6:0,p3:24,dtr:26,gps:'L'},{prof:20,time:80,p15:0,p12:0,p9:0,p6:0,p3:27,dtr:29,gps:'M'},{prof:20,time:85,p15:0,p12:0,p9:0,p6:0,p3:30,dtr:32,gps:'M'},{prof:20,time:90,p15:0,p12:0,p9:0,p6:0,p3:34,dtr:36,gps:'M'},{prof:22,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'B'},{prof:22,time:10,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'C'},{prof:22,time:15,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'D'},{prof:22,time:20,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'E'},{prof:22,time:25,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'F'},{prof:22,time:30,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'G'},{prof:22,time:35,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'H'},{prof:22,time:40,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:4,gps:'I'},{prof:22,time:45,p15:0,p12:0,p9:0,p6:0,p3:7,dtr:9,gps:'I'},{prof:22,time:50,p15:0,p12:0,p9:0,p6:0,p3:12,dtr:14,gps:'J'},{prof:22,time:55,p15:0,p12:0,p9:0,p6:0,p3:16,dtr:18,gps:'K'},{prof:22,time:60,p15:0,p12:0,p9:0,p6:0,p3:20,dtr:22,gps:'K'},{prof:22,time:65,p15:0,p12:0,p9:0,p6:0,p3:25,dtr:27,gps:'L'},{prof:22,time:70,p15:0,p12:0,p9:0,p6:0,p3:29,dtr:31,gps:'L'},{prof:22,time:75,p15:0,p12:0,p9:0,p6:0,p3:33,dtr:35,gps:'M'},{prof:22,time:80,p15:0,p12:0,p9:0,p6:0,p3:37,dtr:39,gps:'M'},{prof:22,time:85,p15:0,p12:0,p9:0,p6:0,p3:41,dtr:43,gps:'N'},{prof:22,time:90,p15:0,p12:0,p9:0,p6:0,p3:44,dtr:46,gps:'N'},{prof:25,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'B'},{prof:25,time:10,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'C'},{prof:25,time:15,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'D'},{prof:25,time:20,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'E'},{prof:25,time:25,p15:0,p12:0,p9:0,p6:0,p3:1,dtr:3,gps:'F'},{prof:25,time:30,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:4,gps:'H'},{prof:25,time:35,p15:0,p12:0,p9:0,p6:0,p3:5,dtr:7,gps:'I'},{prof:25,time:40,p15:0,p12:0,p9:0,p6:0,p3:10,dtr:12,gps:'J'},{prof:25,time:45,p15:0,p12:0,p9:0,p6:0,p3:16,dtr:18,gps:'J'},{prof:25,time:50,p15:0,p12:0,p9:0,p6:0,p3:21,dtr:23,gps:'K'},{prof:25,time:55,p15:0,p12:0,p9:0,p6:0,p3:27,dtr:29,gps:'L'},{prof:25,time:60,p15:0,p12:0,p9:0,p6:0,p3:32,dtr:34,gps:'L'},{prof:25,time:65,p15:0,p12:0,p9:0,p6:0,p3:37,dtr:39,gps:'M'},{prof:25,time:70,p15:0,p12:0,p9:1,p6:41,p3:41,dtr:45,gps:'M'},{prof:25,time:75,p15:0,p12:0,p9:0,p6:4,p3:43,dtr:50,gps:'N'},{prof:25,time:80,p15:0,p12:0,p9:0,p6:7,p3:45,dtr:55,gps:'N'},{prof:25,time:85,p15:0,p12:0,p9:0,p6:9,p3:48,dtr:60,gps:'O'},{prof:25,time:90,p15:0,p12:0,p9:0,p6:11,p3:50,dtr:64,gps:'O'},{prof:28,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'B'},{prof:28,time:10,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'D'},{prof:28,time:15,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'E'},{prof:28,time:20,p15:0,p12:0,p9:0,p6:0,p3:1,dtr:4,gps:'F'},{prof:28,time:25,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:5,gps:'G'},{prof:28,time:30,p15:0,p12:0,p9:0,p6:0,p3:6,dtr:9,gps:'H'},{prof:28,time:35,p15:0,p12:0,p9:0,p6:0,p3:12,dtr:15,gps:'I'},{prof:28,time:40,p15:0,p12:0,p9:0,p6:0,p3:19,dtr:22,gps:'J'},{prof:28,time:45,p15:0,p12:0,p9:0,p6:0,p3:25,dtr:28,gps:'K'},{prof:28,time:50,p15:0,p12:0,p9:0,p6:0,p3:32,dtr:35,gps:'L'},{prof:28,time:55,p15:0,p12:0,p9:0,p6:2,p3:36,dtr:41,gps:'M'},{prof:28,time:60,p15:0,p12:0,p9:0,p6:4,p3:40,dtr:47,gps:'M'},{prof:28,time:65,p15:0,p12:0,p9:0,p6:8,p3:43,dtr:54,gps:'N'},{prof:28,time:70,p15:0,p12:0,p9:0,p6:11,p3:46,dtr:60,gps:'N'},{prof:28,time:75,p15:0,p12:0,p9:0,p6:14,p3:48,dtr:65,gps:'O'},{prof:28,time:80,p15:0,p12:0,p9:0,p6:17,p3:50,dtr:70,gps:'O'},{prof:28,time:85,p15:0,p12:0,p9:0,p6:20,p3:53,dtr:76,gps:'O'},{prof:28,time:90,p15:0,p12:0,p9:0,p6:23,p3:56,dtr:82,gps:'P'},{prof:30,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'B'},{prof:30,time:10,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:2,gps:'D'},{prof:30,time:15,p15:0,p12:0,p9:0,p6:0,p3:1,dtr:4,gps:'E'},{prof:30,time:20,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:5,gps:'F'},{prof:30,time:25,p15:0,p12:0,p9:0,p6:0,p3:4,dtr:7,gps:'H'},{prof:30,time:30,p15:0,p12:0,p9:0,p6:0,p3:9,dtr:12,gps:'I'},{prof:30,time:35,p15:0,p12:0,p9:0,p6:0,p3:17,dtr:20,gps:'J'},{prof:30,time:40,p15:0,p12:0,p9:0,p6:0,p3:24,dtr:27,gps:'K'},{prof:30,time:45,p15:0,p12:0,p9:0,p6:1,p3:31,dtr:35,gps:'L'},{prof:30,time:50,p15:0,p12:0,p9:0,p6:3,p3:36,dtr:42,gps:'M'},{prof:30,time:55,p15:0,p12:0,p9:0,p6:6,p3:39,dtr:48,gps:'M'},{prof:30,time:60,p15:0,p12:0,p9:0,p6:10,p3:43,dtr:56,gps:'N'},{prof:30,time:65,p15:0,p12:0,p9:0,p6:14,p3:46,dtr:63,gps:'N'},{prof:30,time:70,p15:0,p12:0,p9:0,p6:17,p3:48,dtr:68,gps:'O'},{prof:32,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:3,gps:'B'},{prof:32,time:10,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:3,gps:'D'},{prof:32,time:15,p15:0,p12:0,p9:0,p6:0,p3:1,dtr:4,gps:'E'},{prof:32,time:20,p15:0,p12:0,p9:0,p6:0,p3:3,dtr:6,gps:'G'},{prof:32,time:25,p15:0,p12:0,p9:0,p6:0,p3:6,dtr:9,gps:'H'},{prof:32,time:30,p15:0,p12:0,p9:0,p6:0,p3:14,dtr:17,gps:'I'},{prof:32,time:35,p15:0,p12:0,p9:0,p6:0,p3:22,dtr:25,gps:'K'},{prof:32,time:40,p15:0,p12:0,p9:0,p6:1,p3:29,dtr:33,gps:'K'},{prof:32,time:45,p15:0,p12:0,p9:0,p6:4,p3:34,dtr:41,gps:'L'},{prof:32,time:50,p15:0,p12:0,p9:0,p6:7,p3:39,dtr:49,gps:'M'},{prof:32,time:55,p15:0,p12:0,p9:0,p6:11,p3:43,dtr:57,gps:'N'},{prof:32,time:60,p15:0,p12:0,p9:0,p6:15,p3:46,dtr:64,gps:'N'},{prof:32,time:65,p15:0,p12:0,p9:0,p6:19,p3:48,dtr:70,gps:'O'},{prof:32,time:70,p15:0,p12:0,p9:0,p6:23,p3:50,dtr:76,gps:'O'},{prof:35,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:3,gps:'C'},{prof:35,time:10,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:3,gps:'D'},{prof:35,time:15,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:5,gps:'F'},{prof:35,time:20,p15:0,p12:0,p9:0,p6:0,p3:5,dtr:8,gps:'H'},{prof:35,time:25,p15:0,p12:0,p9:0,p6:0,p3:11,dtr:14,gps:'I'},{prof:35,time:30,p15:0,p12:0,p9:0,p6:1,p3:20,dtr:24,gps:'J'},{prof:35,time:35,p15:0,p12:0,p9:0,p6:2,p3:27,dtr:32,gps:'K'},{prof:35,time:40,p15:0,p12:0,p9:0,p6:5,p3:34,dtr:42,gps:'L'},{prof:35,time:45,p15:0,p12:0,p9:0,p6:9,p3:39,dtr:51,gps:'M'},{prof:35,time:50,p15:0,p12:0,p9:0,p6:14,p3:43,dtr:60,gps:'N'},{prof:35,time:55,p15:0,p12:0,p9:0,p6:18,p3:47,dtr:68,gps:'N'},{prof:35,time:60,p15:0,p12:0,p9:0,p6:22,p3:50,dtr:75,gps:'O'},{prof:35,time:65,p15:0,p12:0,p9:2,p6:26,p3:52,dtr:84,gps:'*'},{prof:35,time:70,p15:0,p12:0,p9:4,p6:28,p3:57,dtr:93,gps:'*'},{prof:38,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:3,gps:'C'},{prof:38,time:10,p15:0,p12:0,p9:0,p6:0,p3:1,dtr:4,gps:'E'},{prof:38,time:15,p15:0,p12:0,p9:0,p6:0,p3:4,dtr:7,gps:'F'},{prof:38,time:20,p15:0,p12:0,p9:0,p6:0,p3:8,dtr:11,gps:'H'},{prof:38,time:25,p15:0,p12:0,p9:0,p6:1,p3:16,dtr:21,gps:'J'},{prof:38,time:30,p15:0,p12:0,p9:0,p6:3,p3:24,dtr:31,gps:'K'},{prof:38,time:35,p15:0,p12:0,p9:0,p6:5,p3:33,dtr:42,gps:'L'},{prof:38,time:40,p15:0,p12:0,p9:0,p6:10,p3:38,dtr:52,gps:'M'},{prof:38,time:45,p15:0,p12:0,p9:0,p6:15,p3:43,dtr:62,gps:'N'},{prof:38,time:50,p15:0,p12:0,p9:0,p6:20,p3:47,dtr:71,gps:'N'},{prof:38,time:55,p15:0,p12:0,p9:2,p6:23,p3:50,dtr:79,gps:'O'},{prof:38,time:60,p15:0,p12:0,p9:5,p6:27,p3:53,dtr:89,gps:'P'},{prof:38,time:65,p15:0,p12:0,p9:8,p6:29,p3:58,dtr:99,gps:'*'},{prof:38,time:70,p15:0,p12:0,p9:11,p6:31,p3:62,dtr:108,gps:'*'},{prof:40,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:3,gps:'C'},{prof:40,time:10,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:5,gps:'E'},{prof:40,time:15,p15:0,p12:0,p9:0,p6:0,p3:4,dtr:7,gps:'G'},{prof:40,time:20,p15:0,p12:0,p9:0,p6:1,p3:9,dtr:14,gps:'H'},{prof:40,time:25,p15:0,p12:0,p9:0,p6:2,p3:19,dtr:25,gps:'J'},{prof:40,time:30,p15:0,p12:0,p9:0,p6:4,p3:28,dtr:36,gps:'K'},{prof:40,time:35,p15:0,p12:0,p9:0,p6:8,p3:35,dtr:47,gps:'L'},{prof:40,time:40,p15:0,p12:0,p9:0,p6:13,p3:40,dtr:57,gps:'M'},{prof:40,time:45,p15:0,p12:0,p9:1,p6:18,p3:45,dtr:68,gps:'N'},{prof:40,time:50,p15:0,p12:0,p9:2,p6:23,p3:48,dtr:77,gps:'O'},{prof:40,time:55,p15:0,p12:0,p9:5,p6:26,p3:52,dtr:87,gps:'O'},{prof:40,time:60,p15:0,p12:0,p9:8,p6:29,p3:57,dtr:98,gps:'P'},{prof:40,time:65,p15:0,p12:0,p9:12,p6:31,p3:61,dtr:108,gps:'*'},{prof:40,time:70,p15:0,p12:0,p9:15,p6:33,p3:66,dtr:118,gps:'*'},{prof:42,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:3,gps:'C'},{prof:42,time:10,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:6,gps:'E'},{prof:42,time:15,p15:0,p12:0,p9:0,p6:0,p3:5,dtr:9,gps:'G'},{prof:42,time:20,p15:0,p12:0,p9:0,p6:1,p3:12,dtr:17,gps:'I'},{prof:42,time:25,p15:0,p12:0,p9:0,p6:3,p3:22,dtr:29,gps:'J'},{prof:42,time:30,p15:0,p12:0,p9:0,p6:6,p3:31,dtr:41,gps:'L'},{prof:42,time:35,p15:0,p12:0,p9:0,p6:11,p3:37,dtr:52,gps:'M'},{prof:42,time:40,p15:0,p12:0,p9:1,p6:16,p3:43,dtr:64,gps:'N'},{prof:42,time:45,p15:0,p12:0,p9:3,p6:21,p3:47,dtr:75,gps:'*'},{prof:42,time:50,p15:0,p12:0,p9:6,p6:24,p3:50,dtr:84,gps:'*'},{prof:42,time:55,p15:0,p12:0,p9:8,p6:29,p3:55,dtr:96,gps:'*'},{prof:42,time:60,p15:0,p12:0,p9:13,p6:30,p3:60,dtr:107,gps:'*'},{prof:45,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:3,gps:'C'},{prof:45,time:10,p15:0,p12:0,p9:0,p6:0,p3:3,dtr:7,gps:'F'},{prof:45,time:15,p15:0,p12:0,p9:0,p6:1,p3:6,dtr:11,gps:'H'},{prof:45,time:20,p15:0,p12:0,p9:0,p6:3,p3:15,dtr:22,gps:'I'},{prof:45,time:25,p15:0,p12:0,p9:0,p6:5,p3:25,dtr:34,gps:'K'},{prof:45,time:30,p15:0,p12:0,p9:0,p6:9,p3:35,dtr:48,gps:'L'},{prof:45,time:35,p15:0,p12:0,p9:1,p6:15,p3:40,dtr:60,gps:'M'},{prof:45,time:40,p15:0,p12:0,p9:3,p6:20,p3:46,dtr:73,gps:'N'},{prof:45,time:45,p15:0,p12:0,p9:6,p6:24,p3:50,dtr:84,gps:'*'},{prof:45,time:50,p15:0,p12:0,p9:10,p6:28,p3:54,dtr:96,gps:'*'},{prof:45,time:55,p15:0,p12:0,p9:14,p6:30,p3:60,dtr:108,gps:'*'},{prof:45,time:60,p15:0,p12:1,p9:18,p6:32,p3:65,dtr:121,gps:'*'},{prof:48,time:5,p15:0,p12:0,p9:0,p6:0,p3:0,dtr:4,gps:'D'},{prof:48,time:10,p15:0,p12:0,p9:0,p6:0,p3:4,dtr:8,gps:'F'},{prof:48,time:15,p15:0,p12:0,p9:0,p6:2,p3:7,dtr:13,gps:'H'},{prof:48,time:20,p15:0,p12:0,p9:0,p6:4,p3:19,dtr:27,gps:'J'},{prof:48,time:25,p15:0,p12:0,p9:0,p6:7,p3:30,dtr:41,gps:'K'},{prof:48,time:30,p15:0,p12:0,p9:1,p6:12,p3:37,dtr:55,gps:'M'},{prof:48,time:35,p15:0,p12:0,p9:3,p6:18,p3:44,dtr:70,gps:'N'},{prof:48,time:40,p15:0,p12:0,p9:6,p6:23,p3:48,dtr:82,gps:'O'},{prof:48,time:45,p15:0,p12:0,p9:10,p6:27,p3:53,dtr:95,gps:'*'},{prof:48,time:50,p15:0,p12:1,p9:14,p6:30,p3:59,dtr:109,gps:'*'},{prof:48,time:55,p15:0,p12:2,p9:18,p6:32,p3:64,dtr:121,gps:'*'},{prof:48,time:60,p15:0,p12:5,p9:19,p6:36,p3:70,dtr:135,gps:'*'},{prof:50,time:5,p15:0,p12:0,p9:0,p6:0,p3:1,dtr:5,gps:'D'},{prof:50,time:10,p15:0,p12:0,p9:0,p6:0,p3:4,dtr:8,gps:'F'},{prof:50,time:15,p15:0,p12:0,p9:0,p6:2,p3:9,dtr:15,gps:'H'},{prof:50,time:20,p15:0,p12:0,p9:0,p6:4,p3:22,dtr:30,gps:'J'},{prof:50,time:25,p15:0,p12:0,p9:1,p6:8,p3:32,dtr:46,gps:'L'},{prof:50,time:30,p15:0,p12:0,p9:2,p6:14,p3:39,dtr:60,gps:'M'},{prof:50,time:35,p15:0,p12:0,p9:5,p6:20,p3:45,dtr:75,gps:'N'},{prof:50,time:40,p15:0,p12:0,p9:9,p6:24,p3:50,dtr:88,gps:'O'},{prof:50,time:45,p15:0,p12:1,p9:12,p6:29,p3:55,dtr:102,gps:'*'},{prof:50,time:50,p15:0,p12:2,p9:17,p6:30,p3:62,dtr:116,gps:'*'},{prof:50,time:55,p15:0,p12:5,p9:19,p6:34,p3:67,dtr:130,gps:'*'},{prof:52,time:5,p15:0,p12:0,p9:0,p6:0,p3:1,dtr:5,gps:'D'},{prof:52,time:10,p15:0,p12:0,p9:0,p6:1,p3:4,dtr:10,gps:'F'},{prof:52,time:15,p15:0,p12:0,p9:0,p6:3,p3:10,dtr:18,gps:'I'},{prof:52,time:20,p15:0,p12:0,p9:1,p6:5,p3:23,dtr:34,gps:'K'},{prof:52,time:25,p15:0,p12:0,p9:2,p6:9,p3:34,dtr:50,gps:'L'},{prof:52,time:30,p15:0,p12:0,p9:4,p6:15,p3:41,dtr:65,gps:'M'},{prof:52,time:35,p15:0,p12:0,p9:6,p6:22,p3:47,dtr:80,gps:'O'},{prof:52,time:40,p15:0,p12:1,p9:10,p6:26,p3:52,dtr:94,gps:'O'},{prof:52,time:45,p15:0,p12:2,p9:15,p6:29,p3:59,dtr:110,gps:'*'},{prof:52,time:50,p15:0,p12:5,p9:17,p6:32,p3:64,dtr:123,gps:'*'},{prof:52,time:55,p15:0,p12:8,p9:19,p6:36,p3:71,dtr:139,gps:'*'},{prof:55,time:5,p15:0,p12:0,p9:0,p6:0,p3:1,dtr:5,gps:'D'},{prof:55,time:10,p15:0,p12:0,p9:0,p6:1,p3:5,dtr:11,gps:'G'},{prof:55,time:15,p15:0,p12:0,p9:0,p6:4,p3:13,dtr:22,gps:'I'},{prof:55,time:20,p15:0,p12:0,p9:1,p6:6,p3:27,dtr:39,gps:'K'},{prof:55,time:25,p15:0,p12:0,p9:3,p6:11,p3:37,dtr:56,gps:'M'},{prof:55,time:30,p15:0,p12:0,p9:6,p6:18,p3:44,dtr:73,gps:'N'},{prof:55,time:35,p15:0,p12:1,p9:9,p6:23,p3:50,dtr:88,gps:'O'},{prof:55,time:40,p15:0,p12:3,p9:12,p6:29,p3:55,dtr:104,gps:'P'},{prof:55,time:45,p15:0,p12:5,p9:17,p6:31,p3:62,dtr:120,gps:'*'},{prof:55,time:50,p15:0,p12:8,p9:19,p6:35,p3:69,dtr:136,gps:'*'},{prof:55,time:55,p15:0,p12:12,p9:22,p6:37,p3:76,dtr:152,gps:'*'},{prof:58,time:5,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:7,gps:'D'},{prof:58,time:10,p15:0,p12:0,p9:0,p6:2,p3:5,dtr:12,gps:'G'},{prof:58,time:15,p15:0,p12:0,p9:1,p6:4,p3:16,dtr:26,gps:'J'},{prof:58,time:20,p15:0,p12:0,p9:2,p6:7,p3:30,dtr:44,gps:'K'},{prof:58,time:25,p15:0,p12:0,p9:4,p6:13,p3:40,dtr:62,gps:'M'},{prof:58,time:30,p15:0,p12:1,p9:7,p6:21,p3:46,dtr:81,gps:'N'},{prof:58,time:35,p15:0,p12:2,p9:11,p6:26,p3:52,dtr:97,gps:'O'},{prof:58,time:40,p15:0,p12:5,p9:15,p6:30,p3:59,dtr:115,gps:'P'},{prof:58,time:45,p15:0,p12:8,p9:18,p6:33,p3:66,dtr:131,gps:'*'},{prof:58,time:50,p15:1,p12:11,p9:21,p6:37,p3:74,dtr:150,gps:'*'},{prof:58,time:55,p15:3,p12:14,p9:23,p6:39,p3:83,dtr:168,gps:'*'},{prof:60,time:5,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:7,gps:'D'},{prof:60,time:10,p15:0,p12:0,p9:0,p6:2,p3:6,dtr:13,gps:'G'},{prof:60,time:15,p15:0,p12:0,p9:1,p6:4,p3:19,dtr:29,gps:'J'},{prof:60,time:20,p15:0,p12:0,p9:3,p6:8,p3:32,dtr:48,gps:'L'},{prof:60,time:25,p15:0,p12:0,p9:5,p6:15,p3:41,dtr:66,gps:'M'},{prof:60,time:30,p15:0,p12:1,p9:8,p6:22,p3:48,dtr:85,gps:'O'},{prof:60,time:35,p15:0,p12:4,p9:11,p6:28,p3:54,dtr:103,gps:'P'},{prof:60,time:40,p15:0,p12:6,p9:17,p6:30,p3:62,dtr:121,gps:'P'},{prof:60,time:45,p15:1,p12:9,p9:19,p6:35,p3:69,dtr:139,gps:'*'},{prof:60,time:50,p15:2,p12:13,p9:22,p6:37,p3:78,dtr:158,gps:'*'},{prof:60,time:55,p15:5,p12:15,p9:24,p6:40,p3:88,dtr:178,gps:'*'},{prof:62,time:5,p15:0,p12:0,p9:0,p6:0,p3:2,dtr:7,gps:'*'},{prof:62,time:10,p15:0,p12:0,p9:0,p6:2,p3:7,dtr:14,gps:'*'},{prof:62,time:15,p15:0,p12:0,p9:1,p6:5,p3:21,dtr:33,gps:'*'},{prof:65,time:5,p15:0,p12:0,p9:0,p6:0,p3:3,dtr:8,gps:'*'},{prof:65,time:10,p15:0,p12:0,p9:0,p6:3,p3:8,dtr:16,gps:'*'},{prof:65,time:15,p15:0,p12:0,p9:2,p6:5,p3:24,dtr:37,gps:'*'}];

        function searchTable(depth, time) {
            let bestMatch = null, minDiff = Infinity;
            for (let row of mn90Tables) {
                if (row.prof === depth && row.time >= time) {
                    if (row.time - time < minDiff) { bestMatch = row; minDiff = row.time - time; }
                }
            }
            if (!bestMatch) {
                let depthBelow = 0;
                for (let row of mn90Tables) if (row.prof < depth && row.prof > depthBelow) depthBelow = row.prof;
                for (let row of mn90Tables) {
                    if (row.prof === depthBelow && row.time >= time) {
                        if (!bestMatch || row.time - time < minDiff) { bestMatch = row; minDiff = row.time - time; }
                    }
                }
            }
            return bestMatch || {prof:6, time:15, p15:0, p12:0, p9:0, p6:0, p3:0, dtr:1, gps:'A'};
        }
        
        // Construire une courbe de plong√©e avec couleurs des paliers
        function buildDiveProfileCurve(prof, time, row, color = '#00CCFF') {
            const depths = [];
            const borderColors = [];
            let t = 0;
            const descentRate = 16;
            const descentTime = prof / descentRate;
            
            // DESCENTE (couleur de la courbe)
            for (let i = 0; i <= descentTime; i += 0.5) {
                const depth = (i / descentTime) * prof;
                depths.push(depth);
                borderColors.push(color);
                t = i;
            }
            
            // FOND (couleur de la courbe, pas gris)
            const bottomEnd = descentTime + time;
            for (let i = Math.ceil(t + 1); i <= bottomEnd; i++) {
                depths.push(prof);
                borderColors.push(color);
            }
            t = bottomEnd;
            
            // D√©finir les paliers et leurs couleurs
            const stopDefinitions = [
                { depth: 15, time: row.p15 || 0, color: '#FF99FF' }, // Magenta
                { depth: 12, time: row.p12 || 0, color: '#00DDDD' }, // Cyan clair
                { depth: 9, time: row.p9 || 0, color: '#00FF88' },   // Vert clair
                { depth: 6, time: row.p6 || 0, color: '#FFA500' },   // Orange
                { depth: 3, time: row.p3 || 0, color: '#00FF99' }    // Vert
            ];
            
            let currentDepth = prof;
            
            // Traiter les paliers du plus profond au moins profond
            for (let stop of stopDefinitions) {
                if (stop.time > 0) {
                    // REMONT√âE jusqu'au palier
                    const ascentToStop = (currentDepth - stop.depth) / descentRate;
                    for (let i = 0.5; i <= ascentToStop; i += 0.5) {
                        const d = currentDepth - (i / ascentToStop) * (currentDepth - stop.depth);
                        depths.push(d);
                        borderColors.push(color);
                    }
                    t += ascentToStop;
                    
                    // PALIER avec sa couleur propre
                    for (let i = 0; i < stop.time; i += 0.5) {
                        depths.push(stop.depth);
                        borderColors.push(stop.color);
                    }
                    t += stop.time;
                    currentDepth = stop.depth;
                }
            }
            
            // SURFACE
            if (currentDepth > 0) {
                const ascentToSurface = currentDepth / descentRate;
                for (let i = 0.5; i <= ascentToSurface; i += 0.5) {
                    const d = currentDepth - (i / ascentToSurface) * currentDepth;
                    depths.push(d);
                    borderColors.push(color);
                }
            }
            
            depths.push(0);
            borderColors.push(color);
            
            return { depths, borderColors };
        }
        
        // Mettre √† jour l'affichage des sliders autonomie
        function updateAutSlider(el) {
            const id = el.id;
            const val = el.value;
            const valId = id + '-val';
            
            if (id.includes('conso')) document.getElementById(valId).textContent = val + ' L/min';
            else if (id.includes('vol')) document.getElementById(valId).textContent = val + ' L';
            else if (id.includes('press')) document.getElementById(valId).textContent = val + ' bar';
            else if (id.includes('safety')) document.getElementById(valId).textContent = val + ' bar';
        }
        
        function toggleCurveControls(curveNum) {
            // Initialiser les param√®tres de la courbe au premier clic
            if (!window.autonomyParams) window.autonomyParams = {};
            if (!window.autonomyParams['curve' + curveNum]) {
                window.autonomyParams['curve' + curveNum] = {
                    prof: parseInt(document.getElementById('aut1-prof').value),
                    conso: parseInt(document.getElementById('aut1-conso').value),
                    vol: parseInt(document.getElementById('aut1-vol').value),
                    press: parseInt(document.getElementById('aut1-press').value),
                    safety: parseInt(document.getElementById('aut1-safety').value)
                };
                
                // Afficher les valeurs
                document.getElementById('aut' + curveNum + '-prof-val').textContent = window.autonomyParams['curve' + curveNum].prof;
                document.getElementById('aut' + curveNum + '-conso-val').textContent = window.autonomyParams['curve' + curveNum].conso;
            }
            
            const controlsDiv = document.getElementById('aut' + curveNum + '-controls');
            if (controlsDiv) {
                if (controlsDiv.style.display === 'none' || controlsDiv.style.display === '') {
                    controlsDiv.style.display = 'grid';
                } else {
                    controlsDiv.style.display = 'none';
                }
            }
        }
        
        function modifyParam(paramId, delta) {
            const parts = paramId.split('-');
            const curveNum = parts[0].replace('aut', '');
            const paramType = parts[1]; // 'prof' ou 'conso'
            
            // Copier de la courbe pr√©c√©dente si premi√®re modification
            if (!window.autonomyParams) window.autonomyParams = {};
            if (!window.autonomyParams['curve' + curveNum]) {
                if (curveNum === '2') {
                    window.autonomyParams['curve2'] = {
                        prof: parseInt(document.getElementById('aut1-prof').value),
                        conso: parseInt(document.getElementById('aut1-conso').value),
                        vol: parseInt(document.getElementById('aut1-vol').value),
                        press: parseInt(document.getElementById('aut1-press').value),
                        safety: parseInt(document.getElementById('aut1-safety').value)
                    };
                } else {
                    window.autonomyParams['curve' + curveNum] = {
                        prof: parseInt(document.getElementById('aut1-prof').value),
                        conso: parseInt(document.getElementById('aut1-conso').value),
                        vol: parseInt(document.getElementById('aut1-vol').value),
                        press: parseInt(document.getElementById('aut1-press').value),
                        safety: parseInt(document.getElementById('aut1-safety').value)
                    };
                }
            }
            
            const params = window.autonomyParams['curve' + curveNum];
            
            if (paramType === 'prof') {
                params.prof = Math.max(6, params.prof + delta);
                document.getElementById('aut' + curveNum + '-prof-val').textContent = params.prof;
            } else if (paramType === 'conso') {
                params.conso = Math.max(5, params.conso + delta);
                document.getElementById('aut' + curveNum + '-conso-val').textContent = params.conso;
            } else if (paramType === 'vol') {
                params.vol = Math.max(3, params.vol + delta);
                document.getElementById('aut' + curveNum + '-vol-val').textContent = params.vol;
            } else if (paramType === 'press') {
                params.press = Math.max(100, params.press + (delta * 5));
                document.getElementById('aut' + curveNum + '-press-val').textContent = params.press;
            } else if (paramType === 'safety') {
                params.safety = Math.max(20, params.safety + (delta * 5));
                document.getElementById('aut' + curveNum + '-safety-val').textContent = params.safety;
            }
            
            drawAutonomyChart();
        }
        
        // Calculer la pression r√©siduelle de la bouteille au fil du profil de plong√©e
        // P1*V1 = P2*V2 : Loi des gaz parfaits
        function calculateBottleResidualPressure(depthProfile, consumption, initialPress, volume) {
            const pressureData = [];
            let currentPressure = initialPress;
            
            for (let i = 0; i < depthProfile.length; i++) {
                const depth = depthProfile[i];
                
                // Ne consommer que sous l'eau
                if (depth > 0) {
                    const atmosphericPressure = 1 + depth / 10;
                    const consumptionAtDepth = consumption * atmosphericPressure;
                    currentPressure -= consumptionAtDepth / volume;
                }
                
                pressureData.push(Math.max(0, currentPressure));
            }
            
            return pressureData;
        }
        
        // Dessiner les profils optimis√©s pour autonomie
        function drawAutonomyChart() {
            try {
                // D√©truire le chart pr√©c√©dent (du Planificateur)
                if (window.autonomyChart) window.autonomyChart.destroy();
                if (chart1) chart1.destroy();
                
                // V√©rifier que les √©l√©ments essentiels existent
                const canvas = document.getElementById('profileCanvas');
                if (!canvas) {
                    console.warn('Canvas profileCanvas non trouv√©');
                    return;
                }
                
                // Utiliser les vrais IDs : aut1-prof, aut1-conso, etc.
                const el1 = document.getElementById('aut1-prof');
                const el2 = document.getElementById('aut1-conso');
                const el3 = document.getElementById('aut1-vol');
                const el4 = document.getElementById('aut1-press');
                const el5 = document.getElementById('aut1-safety');
                
                if (!el1 || !el2 || !el3 || !el4 || !el5) {
                    console.warn('Autonomie : √©l√©ments non trouv√©s', {el1, el2, el3, el4, el5});
                    return;
                }
                
                const prof = parseInt(el1.value) || 20;
                const conso = parseInt(el2.value) || 15;
                const vol = parseInt(el3.value) || 12;
                const press = parseInt(el4.value) || 200;
                const safety = parseInt(el5.value) || 50;
                
                // Mettre √† jour l'affichage de la profondeur
                const el1ProfDisplay = document.getElementById('aut1-prof-display');
                if (el1ProfDisplay) el1ProfDisplay.textContent = prof;
                
                console.log('Param√®tres autonomie:', {prof, conso, vol, press, safety});
                
                const airAvailable = (press - safety) * vol;
                if (airAvailable <= 0) {
                    const el = document.getElementById('aut1-maxtime');
                    if (el) el.textContent = 'Pression invalide';
                    return;
                }
                
                // Calculer le temps max pour cette profondeur en finissant √† exactement 50 bar
                let maxBottomTime = 0;
                let bestRow = null;
                
                for (let time = 5; time <= 300; time += 1) {
                    const row = searchTable(prof, time);
                    if (!row) break;
                    
                    // Construire le profil complet
                    const curve = buildDiveProfileCurve(prof, time, row);
                    // Calculer la pression r√©elle √† chaque point
                    const pressureData = calculateBottleResidualPressure(curve.depths, conso, press, vol);
                    const finalPressure = pressureData[pressureData.length - 1];
                    
                    // On cherche le temps qui nous laisse juste √† la limite de s√©curit√© (50 bar)
                    if (finalPressure >= safety) {
                        maxBottomTime = time;
                        bestRow = row;
                    } else {
                        // On a d√©pass√© : on peut s'arr√™ter
                        break;
                    }
                }
                
                if (!bestRow) {
                    const el = document.getElementById('aut1-maxtime');
                    if (el) el.textContent = 'Impossible';
                    return;
                }
                
                // Afficher le temps max
                const el1MaxTime = document.getElementById('aut1-maxtime');
                if (el1MaxTime) el1MaxTime.textContent = minToHHMMSS(maxBottomTime);
                
                // Calculer et afficher le temps total (fond + TOUS les paliers)
                const totalDiveTime = maxBottomTime + (bestRow.p15 || 0) + (bestRow.p12 || 0) + (bestRow.p9 || 0) + (bestRow.p6 || 0) + (bestRow.p3 || 0);
                const el1TotalTime = document.getElementById('aut1-totaltime');
                if (el1TotalTime) el1TotalTime.textContent = minToHHMMSS(totalDiveTime);
                
                // Afficher les d√©tails d'autonomie
                const volDispo = (press - safety) * vol;
                const timeAvailable = Math.floor(volDispo / conso);
                
                const el1CalcStep1 = document.getElementById('aut1-calc-step1');
                const el1CalcStep1b = document.getElementById('aut1-calc-step1b');
                const el1CalcResult1 = document.getElementById('aut1-calc-result1');
                const el1CalcStep2 = document.getElementById('aut1-calc-step2');
                const el1CalcStep2b = document.getElementById('aut1-calc-step2b');
                const el1CalcResult2 = document.getElementById('aut1-calc-result2');
                
                if (el1CalcStep1) el1CalcStep1.textContent = (press - safety);
                if (el1CalcStep1b) el1CalcStep1b.textContent = vol;
                if (el1CalcResult1) el1CalcResult1.textContent = volDispo;
                if (el1CalcStep2) el1CalcStep2.textContent = volDispo;
                if (el1CalcStep2b) el1CalcStep2b.textContent = conso;
                if (el1CalcResult2) el1CalcResult2.textContent = timeAvailable;
                
                // Tracer la courbe 1
                const ctx = canvas.getContext('2d');
                if (!ctx) {
                    console.error('Erreur: impossible d\'obtenir le contexte 2D du canvas');
                    return;
                }
                
                const curve1 = buildDiveProfileCurve(prof, maxBottomTime, bestRow, '#FFFF00');
                const labels = Array.from({length: curve1.depths.length}, (_, i) => i);
                
                // Calculer la pression de la bouteille au fil du temps
                const pressureData = calculateBottleResidualPressure(curve1.depths, conso, press, vol);
                
                console.log('Curve1 depths:', curve1.depths.length, 'Pressure data:', pressureData.length);
                
                let datasets = [{
                    label: `C1`,
                    data: curve1.depths,
                    borderColor: '#FFFF00',
                    backgroundColor: 'transparent',
                    fill: false,
                    tension: 0.3,
                    pointRadius: 0,
                    borderWidth: 2.5,
                    yAxisID: 'y',
                    segment: {
                        borderColor: (context) => curve1.borderColors[context.p0DataIndex] || '#FFFF00'
                    }
                },
                {
                    label: `C1 ü´Å`,
                    data: pressureData,
                    borderColor: '#FFFF00',
                    backgroundColor: 'rgba(255, 255, 0, 0.05)',
                    fill: false,
                    tension: 0.3,
                    pointRadius: 0,
                    borderWidth: 2,
                    borderDash: [3, 3],
                    yAxisID: 'y2'
                }];
                
                // Ajouter courbes 2-4 si activ√©es
                const curveConfigs = [
                    { id: 2, color: '#00FF00', label: 'C2' },
                    { id: 3, color: '#FF99FF', label: 'C3' },
                    { id: 4, color: '#00FFFF', label: 'C4' }
                ];
                
                for (let cfg of curveConfigs) {
                    const checkbox = document.getElementById('aut' + cfg.id + '-enable');
                    if (!checkbox || !checkbox.checked) continue;
                    
                    // R√©cup√©rer les param√®tres
                    if (!window.autonomyParams) window.autonomyParams = {};
                    const params = window.autonomyParams['curve' + cfg.id] || {
                        prof: prof,
                        conso: conso,
                        vol: vol,
                        press: press,
                        safety: safety
                    };
                    
                    const air = (params.press - params.safety) * params.vol;
                    if (air <= 0) continue;
                    
                    let maxTime = 0, row2 = null;
                    for (let time = 5; time <= 300; time += 1) {
                        const r = searchTable(params.prof, time);
                        if (!r) break;
                        
                        // Construire le profil complet
                        const curveTemp = buildDiveProfileCurve(params.prof, time, r, cfg.color);
                        // Calculer la pression r√©elle
                        const pressureTemp = calculateBottleResidualPressure(curveTemp.depths, params.conso, params.press, params.vol);
                        const finalPress = pressureTemp[pressureTemp.length - 1];
                        
                        if (finalPress >= params.safety) {
                            maxTime = time;
                            row2 = r;
                        } else {
                            break;
                        }
                    }
                    
                    if (row2) {
                        const curve2 = buildDiveProfileCurve(params.prof, maxTime, row2, cfg.color);
                        const pressureData2 = calculateBottleResidualPressure(curve2.depths, params.conso, params.press, params.vol);
                        
                        // Ajouter le profil de plong√©e (trait plein)
                        datasets.push({
                            label: `${cfg.label}`,
                            data: curve2.depths,
                            borderColor: cfg.color,
                            backgroundColor: 'transparent',
                            fill: false,
                            tension: 0.3,
                            pointRadius: 0,
                            borderWidth: 2.5,
                            yAxisID: 'y',
                            segment: {
                                borderColor: (context) => curve2.borderColors[context.p0DataIndex] || cfg.color
                            }
                        });
                        
                        // Ajouter la courbe de pression bouteille (pointill√©e)
                        datasets.push({
                            label: `${cfg.label} ü´Å`,
                            data: pressureData2,
                            borderColor: cfg.color,
                            backgroundColor: 'transparent',
                            fill: false,
                            tension: 0.3,
                            pointRadius: 0,
                            borderWidth: 2,
                            borderDash: [3, 3],
                            yAxisID: 'y2'
                        });
                        const maxTimeEl = document.getElementById('aut' + cfg.id + '-maxtime');
                        if (maxTimeEl) maxTimeEl.textContent = minToHHMMSS(maxTime);
                        
                        // Calculer et afficher le temps total (fond + paliers)
                        const totalTime = maxTime + (row2.p15 || 0) + (row2.p12 || 0) + (row2.p9 || 0) + (row2.p6 || 0) + (row2.p3 || 0);
                        const totalTimeEl = document.getElementById('aut' + cfg.id + '-totaltime');
                        if (totalTimeEl) totalTimeEl.textContent = minToHHMMSS(totalTime);
                        
                        // Afficher les d√©tails d'autonomie pour C2, C3, C4
                        const volDispo = (params.press - params.safety) * params.vol;
                        const timeAvailable = Math.floor(volDispo / params.conso);
                        
                        const calcStep1 = document.getElementById('aut' + cfg.id + '-calc-step1');
                        const calcStep1b = document.getElementById('aut' + cfg.id + '-calc-step1b');
                        const calcResult1 = document.getElementById('aut' + cfg.id + '-calc-result1');
                        const calcStep2 = document.getElementById('aut' + cfg.id + '-calc-step2');
                        const calcStep2b = document.getElementById('aut' + cfg.id + '-calc-step2b');
                        const calcResult2 = document.getElementById('aut' + cfg.id + '-calc-result2');
                        
                        if (calcStep1) calcStep1.textContent = (params.press - params.safety);
                        if (calcStep1b) calcStep1b.textContent = params.vol;
                        if (calcResult1) calcResult1.textContent = volDispo;
                        if (calcStep2) calcStep2.textContent = volDispo;
                        if (calcStep2b) calcStep2b.textContent = params.conso;
                        if (calcResult2) calcResult2.textContent = timeAvailable;
                    }
                }
                
                // Calculer maxDepth et maxTimeData √† partir UNIQUEMENT des courbes de profondeur (yAxisID='y')
                let maxDepth = prof + 5;
                let maxTimeData = curve1.depths.length;
                
                for (let dataset of datasets) {
                    if (dataset.yAxisID === 'y' && dataset.data && dataset.data.length > 0) {
                        maxDepth = Math.max(maxDepth, Math.max(...dataset.data.filter(d => d != null && typeof d === 'number')));
                        maxTimeData = Math.max(maxTimeData, dataset.data.length);
                    }
                }
                
                maxDepth = Math.ceil(maxDepth + 2);
                maxTimeData = Math.ceil(maxTimeData * 1.05);
                
                // Calculer min et max de pression bas√©s sur les courbes de pression (yAxisID='y2')
                let pressureMin = press;
                let pressureMax = safety;
                
                for (let dataset of datasets) {
                    if (dataset.yAxisID === 'y2' && dataset.data && dataset.data.length > 0) {
                        const dataValues = dataset.data.filter(d => d != null && typeof d === 'number');
                        if (dataValues.length > 0) {
                            pressureMin = Math.min(pressureMin, Math.min(...dataValues));
                            pressureMax = Math.max(pressureMax, Math.max(...dataValues));
                        }
                    }
                }
                
                // Cr√©er le chart avec AXE SECONDAIRE pour l'autonomie
                window.autonomyChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: datasets
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: { mode: 'nearest', intersect: false },
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(0,0,0,0.9)',
                                titleColor: '#ffff00',
                                bodyColor: '#fff',
                                borderColor: '#00ffff',
                                borderWidth: 2
                            }
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                reverse: true,
                                min: 0,
                                max: maxDepth,
                                title: { display: true, text: 'Profondeur (m)', color: '#FFFF00', font: { size: 12, weight: 'bold' } },
                                ticks: { color: '#FFFF00' },
                                grid: { color: 'rgba(255, 255, 0, 0.2)' }
                            },
                            y2: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                min: pressureMin,
                                max: pressureMax,
                                title: { display: true, text: 'Pression (bar)', color: '#FF6B6B', font: { size: 12, weight: 'bold' } },
                                ticks: { color: '#FF6B6B' },
                                grid: { drawOnChartArea: false, color: 'rgba(255, 107, 107, 0.1)' }
                            },
                            x: {
                                title: { display: true, text: 'Temps (min)', color: '#00ffff', font: { size: 12, weight: 'bold' } },
                                ticks: { color: '#00ffff' },
                                grid: { color: 'rgba(0, 255, 255, 0.2)' }
                            }
                        }
                    }
                });
                
                // G√©n√©rer une l√©gende personnalis√©e
                const legendContainer = document.getElementById('autonomy-legend');
                if (legendContainer) {
                    legendContainer.innerHTML = '';
                    
                    // Cr√©er la l√©gende group√©e par couple (profil + pression) - format compact
                    let legendHTML = '';
                    
                    for (let cfg of [{ id: 1, color: '#FFFF00', label: 'C1' }, { id: 2, color: '#00FF00', label: 'C2' }, { id: 3, color: '#FF99FF', label: 'C3' }, { id: 4, color: '#00FFFF', label: 'C4' }]) {
                        const checkbox = cfg.id === 1 ? true : (document.getElementById('aut' + cfg.id + '-enable')?.checked || false);
                        if (cfg.id === 1 || checkbox) {
                            // R√©cup√©rer le temps max affiche pour cette courbe
                            const maxTimeEl = document.getElementById('aut' + cfg.id + '-maxtime');
                            const maxTimeText = maxTimeEl ? maxTimeEl.textContent : '--';
                            
                            legendHTML += `
                                <div style="display: flex; flex-direction: column; gap: 2px; padding: 4px 8px; background: rgba(${cfg.color === '#FFFF00' ? '255,255,0' : cfg.color === '#00FF00' ? '0,255,0' : cfg.color === '#FF99FF' ? '255,153,255' : '0,255,255'},0.1); border-left: 2px solid ${cfg.color}; border-radius: 3px; font-size: 9px;">
                                    <div style="display: flex; align-items: center; gap: 3px;">
                                        <div style="width: 8px; height: 2px; background: ${cfg.color};"></div>
                                        <span style="color: ${cfg.color}; font-weight: bold;">${cfg.label}</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 3px;">
                                        <svg width="8" height="2" style="overflow: visible;">
                                            <line x1="0" y1="1" x2="8" y2="1" stroke="${cfg.color}" stroke-width="1.5" stroke-dasharray="2,2"/>
                                        </svg>
                                        <span style="color: ${cfg.color};">‚è±Ô∏è ${maxTimeText}</span>
                                    </div>
                                </div>
                            `;
                        }
                    }
                    
                    legendContainer.innerHTML = legendHTML;
                }
                
                console.log('Chart cr√©√© avec succ√®s');
            } catch (error) {
                console.error('Erreur dans drawAutonomyChart:', error);
            }
        }

        function scrollToElement(id) {
            const el = document.getElementById(id);
            if (el) el.scrollIntoView({behavior: 'smooth'});
        }
        
        function switchTab(tabNum) {
            currentTab = tabNum;
            const leftPanel = document.querySelector('.left-panel');
            document.getElementById('tab0-left').style.display = tabNum === 0 ? 'flex' : 'none';
            document.getElementById('tab1-left').style.display = tabNum === 1 ? 'flex' : 'none';
            document.getElementById('tab2-left').style.display = tabNum === 2 ? 'flex' : 'none';
            document.getElementById('rightPanel').style.display = tabNum === 2 ? 'none' : 'flex';
            document.getElementById('splitter').style.display = tabNum === 2 ? 'none' : 'block';
            leftPanel.classList.toggle('tab2-active', tabNum === 2);
            document.querySelectorAll('.tab-btn').forEach((el, i) => el.classList.toggle('active', i === tabNum));
            if (tabNum === 0) { setTimeout(() => calculate(), 50); }
            else if (tabNum === 1) { setTimeout(() => drawAutonomyChart(), 50); }
            else if (tabNum === 2) { setTimeout(() => generateTables(), 50); }
            if (chart1) setTimeout(() => chart1.resize(), 100);
        }

        function switchDiveView() {
            superposedView = document.getElementById('view-toggle').checked;
            const toggleText = document.getElementById('toggle-text-menu');
            toggleText.textContent = superposedView ? 'üìä Combin√©' : 'üìä Superpos√©';
            
            // Redessiner le graphe avec la nouvelle vue
            const depth = parseInt(document.getElementById('depth1').value);
            const time = parseInt(document.getElementById('time1').value);
            const row = searchTable(depth, time);
            const dive2Checkbox = document.getElementById('dive2-checkbox');
            drawDiveProfile(depth, time, row, dive2Checkbox.checked ? parseInt(document.getElementById('dive2-interval').value) : 0);
        }

        function calculate() {
            try {
                // D√©truire le chart pr√©c√©dent pour forcer la recr√©ation
                if (chart1) {
                    chart1.destroy();
                    chart1 = null;
                }
                
                const depth = parseInt(document.getElementById('depth1').value);
                const time = parseInt(document.getElementById('time1').value);
                const row = searchTable(depth, time);
                
                if (!row) {
                    console.error('Pas de ligne trouv√©e pour', depth, time);
                    return;
                }
                
                // G√©n√©rer la ligne des paliers
                let paliersLine = [];
                if (row.p15 && row.p15 > 0) paliersLine.push(`15m: ${row.p15}min`);
                if (row.p12 && row.p12 > 0) paliersLine.push(`12m: ${row.p12}min`);
                if (row.p9 && row.p9 > 0) paliersLine.push(`9m: ${row.p9}min`);
                if (row.p6 && row.p6 > 0) paliersLine.push(`6m: ${row.p6}min`);
                if (row.p3 && row.p3 > 0) paliersLine.push(`3m: ${row.p3}min`);
                
                document.getElementById('paliers-line').textContent = paliersLine.length > 0 ? paliersLine.join(' / ') : 'Aucun';
                document.getElementById('dtr1').textContent = row.dtr + ' min';
                document.getElementById('gps1').textContent = row.gps;
                
                const warningMsg = row.gps === '*' ? '‚ö†Ô∏è PLONG√âES SUCCESSIVES INTERDITES' : '';
                document.getElementById('warning1').innerHTML = warningMsg;
                document.getElementById('warning1').style.display = warningMsg ? 'block' : 'none';
                
                const totalTime = time + row.p6 + row.p3 + 3;
                document.getElementById('total1').textContent = minToHHMM(totalTime);
                
                // G√©rer l'affichage de la 2e plong√©e
                const dive2Checkbox = document.getElementById('dive2-checkbox');
                const dive2Options = document.getElementById('dive2-options');
                dive2Options.style.display = dive2Checkbox.checked ? 'block' : 'none';
                
                // Tracer le profil (avec 2e plong√©e si coch√©e)
                drawDiveProfile(depth, time, row, dive2Checkbox.checked ? parseInt(document.getElementById('dive2-interval').value) : 0);
            } catch (error) {
                console.error('Erreur dans calculate():', error);
            }
        }
        
        function generateSuggestions(depth) {
            const container = document.getElementById('suggestions-container');
            container.innerHTML = '';
            
            // Trouver le profil OPTIMAL unique (le plus long temps possible)
            let bestSuggestion = null;
            const times = [15, 20, 25, 30, 35, 40, 45, 50];
            
            for (let t of times) {
                const row = searchTable(depth, t);
                if (row) {
                    if (!bestSuggestion || t > bestSuggestion.time) {
                        bestSuggestion = {
                            time: t,
                            p6: row.p6,
                            p3: row.p3,
                            dtr: row.dtr,
                            gps: row.gps,
                            row: row
                        };
                    }
                }
            }
            
            // Stocker pour drawDiveProfile
            window.storedSuggestions = [bestSuggestion];
            
            if (bestSuggestion) {
                const totalTime = bestSuggestion.time + bestSuggestion.p6 + bestSuggestion.p3 + 3;
                const warning = bestSuggestion.gps === '*' ? ' üö´ Successives interdites' : '';
                const html = `<div style="background: rgba(0,255,150,0.2); padding: 10px; border-radius: 4px; border: 2px solid #00FF99; font-size: 10px; text-align: center;">
                    <strong style="color: #00FF99; font-size: 12px;">‚≠ê PROFIL OPTIMAL ‚≠ê</strong><br/>
                    <span style="color: #00FFFF; font-size: 14px; font-weight: bold;">${minToHHMM(bestSuggestion.time)}</span> au fond<br/>
                    P6: ${bestSuggestion.p6}m | P3: ${bestSuggestion.p3}m | GPS: <strong style="font-size: 12px;">${bestSuggestion.gps}</strong>${warning}
                </div>`;
                container.innerHTML = html;
            }
        }
        
        // Calcul d'autonomie r√©elle avec consommation
        function calculateAutonomy() {
            const depth = parseInt(document.getElementById('auto-prof').value) || 20;
            const consoAvg = parseFloat(document.getElementById('conso-avg').value) || 25;
            const bottleVol = parseFloat(document.getElementById('bottle-vol').value) || 15;
            const bottlePress = parseInt(document.getElementById('bottle-press').value) || 200;
            const safetyBar = parseInt(document.getElementById('safety-bar').value) || 50;
            
            // Air disponible = volume * pression dispo
            const availableBar = bottlePress - safetyBar;
            const availableAir = availableBar * bottleVol;
            
            document.getElementById('auto-air-available').textContent = availableAir.toFixed(0);
            
            // Chercher le meilleur profil pour cette profondeur
            let bestTime = 0;
            let bestRow = null;
            
            // Tester diff√©rents temps jusqu'√† trouver le max viable
            for (let t = 5; t <= 300; t += 5) {
                const row = searchTable(depth, t);
                if (!row) continue;
                
                const descentTime = depth / 16;
                const totalPalierTime = row.p6 + row.p3;
                const bottomConsumption = consoAvg * t;
                const descentConsumption = consoAvg * descentTime;
                const ascentConsumption = (consoAvg * 0.7) * (totalPalierTime + 2);
                const totalConsumption = bottomConsumption + descentConsumption + ascentConsumption;
                
                if (totalConsumption <= availableAir) {
                    bestTime = t;
                    bestRow = row;
                } else {
                    break;
                }
            }
            
            if (bestRow) {
                const descentTime = depth / 16;
                const totalPalierTime = bestRow.p6 + bestRow.p3;
                document.getElementById('auto-deco-time').textContent = totalPalierTime;
                document.getElementById('auto-conso-total').textContent = (consoAvg * bestTime).toFixed(0);
                document.getElementById('auto-time-final').textContent = minToHHMM(bestTime);
                
                generateAutonomyProposals(consoAvg, bottleVol, bottlePress, safetyBar, availableAir);
            }
        }
        
        function generateAutonomyProposals(consoAvg, bottleVol, bottlePress, safetyBar, availableAir) {
            const container = document.getElementById('autonomy-profiles-container');
            if (!container) return;
            container.innerHTML = '';
            
            const proposals = [];
            
            // Tester diff√©rentes profondeurs pour trouver des options optimales
            for (let prof = 10; prof <= 50; prof += 5) {
                for (let time = 10; time <= 250; time += 10) {
                    const row = searchTable(prof, time);
                    if (!row) continue;
                    
                    const descentTime = prof / 16;
                    const totalPalierTime = row.p6 + row.p3;
                    const bottomConsumption = consoAvg * time;
                    const descentConsumption = consoAvg * descentTime;
                    const ascentConsumption = (consoAvg * 0.7) * (totalPalierTime + 2);
                    const totalConsumption = bottomConsumption + descentConsumption + ascentConsumption;
                    
                    // Garder les profils qui utilisent 90-100% de l'air dispo
                    if (totalConsumption <= availableAir && totalConsumption > availableAir * 0.85) {
                        proposals.push({ prof, time, consum: totalConsumption, deco: totalPalierTime });
                    }
                }
            }
            
            // Afficher les 5 meilleurs
            proposals.sort((a, b) => b.time - a.time).slice(0, 5).forEach((p) => {
                const html = `<div style="background: rgba(0,255,150,0.15); padding: 6px; border-radius: 4px; border-left: 2px solid #00FF99; cursor: pointer; font-size: 8px;"
                    onmouseover="this.style.background='rgba(0,255,150,0.3)'" 
                    onmouseout="this.style.background='rgba(0,255,150,0.15)'">
                    <strong style="color: #00FF99;">${p.prof}m/${p.time}min</strong> | Paliers: ${p.deco}min | Air: ${p.consum.toFixed(0)}L
                </div>`;
                container.innerHTML += html;
            });
        }

        function drawDiveProfile(maxDepth, bottomTime, row, dive2Interval = 0) {
            const canvas = document.getElementById('profileCanvas');
            const ctx = canvas.getContext('2d');
            
            // D√©truire les charts pr√©c√©dents
            if (chart1) chart1.destroy();
            if (window.autonomyChart) window.autonomyChart.destroy();
            chart1 = null;
            window.autonomyChart = null;
            
            // Afficher/masquer le toggle pour vue superpos√©e si 2e plong√©e
            const toggleLabel = document.getElementById('view-toggle-label-menu');
            if (dive2Interval > 0) {
                toggleLabel.style.display = 'flex';
            } else {
                toggleLabel.style.display = 'none';
                superposedView = false;
                document.getElementById('view-toggle').checked = false;
            }
            
            // Titre simple
            const titleEl = document.getElementById('graph-title');
            if (titleEl) {
                titleEl.textContent = 'üìä Profil de Plong√©e';
            }
            
            // R√©cup√©rer les param√®tres de la 2e plong√©e
            const dive2Depth = dive2Interval > 0 ? parseInt(document.getElementById('dive2-depth').value) : maxDepth;
            const dive2Time = dive2Interval > 0 ? parseInt(document.getElementById('dive2-time').value) : bottomTime;
            const dive2Row = dive2Interval > 0 ? searchTable(dive2Depth, dive2Time) : row;
            
            // Afficher les r√©sultats de la 2e plong√©e
            if (dive2Interval > 0 && dive2Row) {
                // G√©n√©rer la ligne des paliers pour la 2e plong√©e
                let paliersLine2 = [];
                if (dive2Row.p15 && dive2Row.p15 > 0) paliersLine2.push(`15m: ${dive2Row.p15}min`);
                if (dive2Row.p12 && dive2Row.p12 > 0) paliersLine2.push(`12m: ${dive2Row.p12}min`);
                if (dive2Row.p9 && dive2Row.p9 > 0) paliersLine2.push(`9m: ${dive2Row.p9}min`);
                if (dive2Row.p6 && dive2Row.p6 > 0) paliersLine2.push(`6m: ${dive2Row.p6}min`);
                if (dive2Row.p3 && dive2Row.p3 > 0) paliersLine2.push(`3m: ${dive2Row.p3}min`);
                
                document.getElementById('paliers-line2').textContent = paliersLine2.length > 0 ? paliersLine2.join(' / ') : 'Aucun';
                document.getElementById('dtr2').textContent = dive2Row.dtr + ' min';
                document.getElementById('gps2').textContent = dive2Row.gps;
            }
            
            const curve1 = buildDiveProfileCurve(maxDepth, bottomTime, row, '#FFDD88');
            const curve2 = dive2Interval > 0 ? buildDiveProfileCurve(dive2Depth, dive2Time, dive2Row, '#BB88EE') : null;
            
            if (!superposedView) {
                // MODE COMBIN√â - Chronologique
                const labels = [], depthData = [];
                let time = 0;
                
                // PLONG√âE 1
                const maxTime1 = curve1.depths.length;
                for (let i = 0; i < curve1.depths.length; i++) {
                    labels.push(i);
                    depthData.push(curve1.depths[i]);
                    time = i;
                }
                
                // SURFACE ET PLONG√âE 2
                if (dive2Interval > 0) {
                    const surfaceStart = time + 1;
                    const surfaceEnd = surfaceStart + dive2Interval;
                    for (let t = surfaceStart; t <= surfaceEnd; t++) {
                        labels.push(t);
                        depthData.push(0);
                    }
                    time = surfaceEnd;
                    
                    for (let i = 0; i < curve2.depths.length; i++) {
                        labels.push(time + i);
                        depthData.push(curve2.depths[i]);
                    }
                    time += curve2.depths.length;
                }
                
                // Cr√©er le dataset
                const datasets = [{
                    label: '‚≠ê PROFIL DE PLONG√âE ‚≠ê',
                    data: depthData,
                    borderColor: '#00ffff',
                    backgroundColor: 'rgba(0, 255, 255, 0.1)',
                    fill: true,
                    tension: 0.3,
                    pointRadius: 0,
                    borderWidth: 3,
                    segment: {
                        borderColor: (context) => {
                            const idx = context.p0DataIndex;
                            if (idx >= 0 && idx < curve1.borderColors.length) {
                                return curve1.borderColors[idx];
                            }
                            if (dive2Interval > 0 && idx >= maxTime1 + dive2Interval) {
                                const idx2 = idx - maxTime1 - dive2Interval;
                                if (idx2 >= 0 && idx2 < curve2.borderColors.length) {
                                    return curve2.borderColors[idx2];
                                }
                            }
                            return '#00ffff';
                        }
                    }
                }];
                
                chart1 = createDiveChart(ctx, labels, datasets, Math.max(maxDepth, dive2Depth) + 5);
            } else {
                // MODE SUPERPOS√â - Les deux courbes c√¥te √† c√¥te
                const maxLen = Math.max(curve1.depths.length, curve2 ? curve2.depths.length : 0);
                const labels = Array.from({length: maxLen}, (_, i) => i);
                
                const datasets = [
                    {
                        label: `üü¶ Plong√©e 1 - ${maxDepth}m/${minToHHMM(bottomTime)}`,
                        data: curve1.depths.concat(Array(maxLen - curve1.depths.length).fill(null)),
                        borderColor: '#FFDD88',
                        backgroundColor: 'rgba(255, 221, 136, 0.1)',
                        fill: true,
                        tension: 0.3,
                        pointRadius: 0,
                        borderWidth: 2.5,
                        segment: {
                            borderColor: (context) => {
                                const idx = context.p0DataIndex;
                                return idx < curve1.borderColors.length ? curve1.borderColors[idx] : '#FFDD88';
                            }
                        }
                    }
                ];
                
                if (curve2) {
                    datasets.push({
                        label: `üüß Plong√©e 2 - ${dive2Depth}m/${minToHHMM(dive2Time)} (Intervalle: ${dive2Interval}min)`,
                        data: curve2.depths.concat(Array(maxLen - curve2.depths.length).fill(null)),
                        borderColor: '#BB88EE',
                        backgroundColor: 'rgba(187, 136, 238, 0.05)',
                        fill: true,
                        tension: 0.3,
                        pointRadius: 0,
                        borderWidth: 2.5,
                        borderDash: [4, 4],
                        segment: {
                            borderColor: (context) => {
                                const idx = context.p0DataIndex;
                                return idx < curve2.borderColors.length ? curve2.borderColors[idx] : '#BB88EE';
                            }
                        }
                    });
                }
                
                chart1 = createDiveChart(ctx, labels, datasets, Math.max(maxDepth, dive2Depth) + 5);
            }
        }

        function createDiveChart(ctx, labels, datasets, maxY) {
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'nearest', intersect: false },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#00ffff',
                                font: { size: 12, weight: 'bold' },
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.9)',
                            titleColor: '#ffff00',
                            bodyColor: '#fff',
                            borderColor: '#00ffff',
                            borderWidth: 2,
                            padding: 12,
                            titleFont: { size: 13, weight: 'bold' },
                            callbacks: {
                                title: function(context) {
                                    const depth = context[0].parsed.y;
                                    if (depth === 0) return 'üåä SURFACE';
                                    if (depth === 3) return '‚≠ê PALIER 3M (temps stable)';
                                    if (depth === 6) return '‚≠ê PALIER 6M (temps stable)';
                                    return 'PROFONDEUR';
                                },
                                label: function(context) {
                                    return context.parsed.y.toFixed(1) + ' m';
                                },
                                afterLabel: function(context) {
                                    return 'Temps: ' + Math.round(context.label * 10) / 10 + ' min';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            reverse: true,
                            min: 0,
                            max: maxY,
                            title: { display: true, text: 'Profondeur (m)', color: '#00ffff', font: { size: 13, weight: 'bold' } },
                            ticks: { color: '#00ffff', font: { size: 11 } },
                            grid: { color: 'rgba(0, 255, 255, 0.2)', drawBorder: true, borderColor: '#00ffff' }
                        },
                        x: {
                            title: { display: true, text: 'Temps (minutes)', color: '#00ffff', font: { size: 13, weight: 'bold' } },
                            ticks: { color: '#00ffff', font: { size: 11 } },
                            grid: { color: 'rgba(0, 255, 255, 0.2)', drawBorder: true, borderColor: '#00ffff' }
                        }
                    }
                }
            });
        }

        function calculateOptimalDive() {
            const prof = parseInt(document.getElementById('prof-auto').value) || 20;
            const row = searchTable(prof, 30);
            document.getElementById('autonomy-optimal').textContent = minToHHMM(30);
            document.getElementById('aut-p6').textContent = row.p6;
            document.getElementById('aut-p3').textContent = row.p3;
            document.getElementById('aut-dtr').textContent = row.dtr;
            drawDiveProfile(prof, 30, row);
        }

        function generateTables() {
            const container = document.getElementById('tab2-left');
            
            const depths = new Set();
            for (let row of mn90Tables) depths.add(row.prof);
            const depthArray = Array.from(depths).sort((a, b) => a - b);
            
            // Menu gauche avec tous les boutons
            let menuHtml = '<div id="tab2-menu"><div id="tab2-menu-title">üéØ PROFONDEURS</div>';
            for (let depth of depthArray) {
                menuHtml += `<button onclick="const el = document.getElementById('depth-${depth}'); if(el) el.scrollIntoView({behavior: 'smooth'});">${depth}m</button>`;
            }
            menuHtml += '<div style="grid-column: 1 / -1; margin-top: 12px; padding-top: 10px; border-top: 1px solid rgba(0,255,255,0.3); color: #00ffff; font-size: 9px; font-weight: bold; margin-bottom: 6px;">üìä TABLEAUX AUX</div>';
            menuHtml += '<button onclick="scrollToElement(\'tableau-i\')" style="grid-column: 1 / -1;">Tableau I</button>';
            menuHtml += '<button onclick="scrollToElement(\'tableau-ii\')" style="grid-column: 1 / -1;">Tableau II</button>';
            menuHtml += '<button onclick="scrollToElement(\'tableau-iii\')" style="grid-column: 1 / -1;">Tableau III</button>';
            menuHtml += '<button onclick="scrollToElement(\'tableau-iv\')" style="grid-column: 1 / -1;">Tableau IV</button>';
            menuHtml += '</div>';
            
            // Contenu droit avec les tableaux
            let html = '<div id="tab2-content"><div style="color: #00ffff; margin-bottom: 15px; font-size: 11px; text-align: center;"><strong>üìä Tables MN90-FFESSM - ' + mn90Tables.length + ' lignes</strong></div>';
            let totalRows = 0;
            
            for (let depth of depthArray) {
                const rows = mn90Tables.filter(r => r.prof === depth);
                totalRows += rows.length;
                html += `<div id="depth-${depth}" style="margin-bottom: 18px; background: rgba(0,255,255,0.1); padding: 10px; border-radius: 8px; border-left: 4px solid #00ffff;">
                    <h3 style="color: #00ffff; margin-bottom: 10px; font-size: 12px;">Profondeur <strong>${depth}m</strong> (${rows.length})</h3>
                    <table style="width: 100%; border-collapse: collapse; font-size: 9px; table-layout: fixed;">
                    <thead><tr style="background: #003366; color: #00ffff; position: sticky; top: 0;">
                        <th style="padding: 1px 0; border: 1px solid #00ffff; width: 26px;">Tps</th>
                        <th style="padding: 1px 0; border: 1px solid #00ffff; width: 10px;">P15</th>
                        <th style="padding: 1px 0; border: 1px solid #00ffff; width: 10px;">P12</th>
                        <th style="padding: 1px 0; border: 1px solid #00ffff; width: 10px;">P9</th>
                        <th style="padding: 1px 0; border: 1px solid #00ffff; width: 10px;">P6</th>
                        <th style="padding: 1px 0; border: 1px solid #00ffff; width: 10px;">P3</th>
                        <th style="padding: 1px 0; border: 1px solid #00ffff; background: rgba(0,200,255,0.3); width: 14px;"><strong>DTR</strong></th>
                        <th style="padding: 1px 0; border: 1px solid #00ffff; width: 12px;">GPS</th>
                    </tr></thead>
                    <tbody>`;
                    
                for (let row of rows) {
                    const isReduc = row.gps === '*' ? 'background: rgba(255,50,50,0.25);' : '';
                    const color = row.gps === '*' ? 'color: #ff3333;' : 'color: #fff;';
                    html += `<tr style="${color}${isReduc}">
                        <td style="padding: 1px 0; border: 1px solid rgba(0,255,255,0.15); text-align: center; font-weight: bold; word-break: break-word;">${minToHHMM(row.time)}</td>
                        <td style="padding: 1px 0; border: 1px solid rgba(0,255,255,0.15); text-align: center; word-break: break-word;">${row.p15}</td>
                        <td style="padding: 1px 0; border: 1px solid rgba(0,255,255,0.15); text-align: center; word-break: break-word;">${row.p12}</td>
                        <td style="padding: 1px 0; border: 1px solid rgba(0,255,255,0.15); text-align: center; word-break: break-word;">${row.p9}</td>
                        <td style="padding: 1px 0; border: 1px solid rgba(0,255,255,0.15); text-align: center; word-break: break-word;">${row.p6}</td>
                        <td style="padding: 1px 0; border: 1px solid rgba(0,255,255,0.15); text-align: center; word-break: break-word;">${row.p3}</td>
                        <td style="padding: 1px 0; border: 1px solid rgba(0,255,255,0.15); text-align: center; background: rgba(0,200,255,0.2); font-weight: bold; word-break: break-word;">${row.dtr}</td>
                        <td style="padding: 1px 0; border: 1px solid rgba(0,255,255,0.15); text-align: center; font-weight: bold; word-break: break-word;">${row.gps}</td>
                    </tr>`;
                }
                html += '</tbody></table></div>';
            }
            // Tableau I - Azote R√©siduel
            html += '<div id="tableau-i" style="margin-bottom: 18px; background: rgba(255,153,0,0.1); padding: 10px; border-radius: 8px; border-left: 4px solid #FF9900;"><h3 style="color: #FF9900; margin-bottom: 10px; font-size: 12px;">üìä Tableau I - Azote R√©siduel</h3><div style="font-size: 8px; color: #FFFFFF; margin-bottom: 8px;">√âvolution de l\'azote r√©siduel entre deux plong√©es</div><table style="width: 100%; border-collapse: collapse; font-size: 8px;"><thead><tr style="background: #4d3300;"><th style="border: 1px solid #FF9900; padding: 3px;">Groupe</th><th style="border: 1px solid #FF9900; padding: 3px;">00:15</th><th style="border: 1px solid #FF9900; padding: 3px;">00:30</th><th style="border: 1px solid #FF9900; padding: 3px;">00:45</th><th style="border: 1px solid #FF9900; padding: 3px;">01:00</th><th style="border: 1px solid #FF9900; padding: 3px;">02:00</th><th style="border: 1px solid #FF9900; padding: 3px;">03:00</th><th style="border: 1px solid #FF9900; padding: 3px;">04:00</th><th style="border: 1px solid #FF9900; padding: 3px;">05:00</th><th style="border: 1px solid #FF9900; padding: 3px;">06:00</th><th style="border: 1px solid #FF9900; padding: 3px;">08:00</th><th style="border: 1px solid #FF9900; padding: 3px;">12:00</th></tr></thead><tbody>';
            const azote1Data = [['A','0.84','0.83','0.83','0.83','0.82','0.81','0.81','0.81','0.81','0.81','0.81'],['B','0.88','0.88','0.87','0.86','0.85','0.83','0.82','0.82','0.81','0.81','0.81'],['C','0.92','0.91','0.90','0.89','0.87','0.85','0.83','0.82','0.82','0.81','0.81'],['D','0.97','0.95','0.94','0.93','0.89','0.86','0.85','0.83','0.82','0.81','0.81'],['E','1.00','0.98','0.97','0.96','0.91','0.88','0.86','0.84','0.83','0.81','0.81'],['F','1.05','1.03','1.01','0.99','0.94','0.90','0.87','0.85','0.83','0.81','0.81'],['G','1.08','1.06','1.04','1.02','0.96','0.91','0.88','0.85','0.84','0.81','0.81'],['H','1.13','1.10','1.08','1.05','0.98','0.93','0.89','0.86','0.85','0.82','0.81'],['I','1.17','1.14','1.11','1.08','1.00','0.94','0.90','0.87','0.85','0.83','0.81'],['J','1.20','1.17','1.14','1.11','1.02','0.96','0.91','0.88','0.86','0.83','0.81'],['K','1.25','1.21','1.18','1.15','1.04','0.97','0.92','0.89','0.86','0.83','0.81'],['L','1.29','1.25','1.21','1.17','1.07','0.99','0.93','0.89','0.87','0.82','0.81'],['M','1.33','1.29','1.25','1.21','1.09','1.01','0.94','0.90','0.87','0.82','0.81'],['N','1.37','1.32','1.28','1.24','1.11','1.02','0.95','0.91','0.88','0.82','0.81'],['O','1.41','1.36','1.32','1.27','1.13','1.04','0.97','0.92','0.88','0.82','0.81'],['P','1.45','1.40','1.35','1.30','1.15','1.05','0.98','0.93','0.89','0.82','0.81']];
            for (let row of azote1Data) { html += '<tr style="color: #FF9900;"><td style="border: 1px solid rgba(255,153,0,0.3); padding: 3px; font-weight: bold;">'+row[0]+'</td>'; for (let i=1; i<row.length; i++) html += '<td style="border: 1px solid rgba(255,153,0,0.3); padding: 3px; text-align: center;">'+row[i]+'</td>'; html += '</tr>'; }
            html += '</tbody></table></div>';
            
            // Tableau II - Majoration
            html += '<div id="tableau-ii" style="margin-bottom: 18px; background: rgba(0,200,100,0.1); padding: 10px; border-radius: 8px; border-left: 4px solid #00FF99;"><h3 style="color: #00FF99; margin-bottom: 10px; font-size: 12px;">üìä Tableau II - Majoration</h3><div style="font-size: 8px; color: #FFFFFF; margin-bottom: 8px;">D√©termination de la majoration en minutes</div><div style="overflow-x: auto;"><table style="width: 100%; border-collapse: collapse; font-size: 7px;"><thead><tr style="background: #003333;"><th style="border: 1px solid #00FF99; padding: 2px;">Azote</th><th style="border: 1px solid #00FF99; padding: 2px;">12</th><th style="border: 1px solid #00FF99; padding: 2px;">15</th><th style="border: 1px solid #00FF99; padding: 2px;">18</th><th style="border: 1px solid #00FF99; padding: 2px;">20</th><th style="border: 1px solid #00FF99; padding: 2px;">25</th><th style="border: 1px solid #00FF99; padding: 2px;">30</th><th style="border: 1px solid #00FF99; padding: 2px;">35</th><th style="border: 1px solid #00FF99; padding: 2px;">40</th><th style="border: 1px solid #00FF99; padding: 2px;">45</th><th style="border: 1px solid #00FF99; padding: 2px;">50</th><th style="border: 1px solid #00FF99; padding: 2px;">55</th><th style="border: 1px solid #00FF99; padding: 2px;">60</th></tr></thead><tbody>';
            const majorData = [['0.82','4','3','2','2','2','1','1','1','1','1','1','1'],['0.89','17','13','11','10','8','7','6','5','4','4','4','3'],['0.99','38','30','24','22','17','14','12','11','9','8','8','7'],['1.11','68','52','42','37','29','24','20','18','16','14','13','12'],['1.24','106','79','63','56','43','35','30','26','23','20','18','17'],['1.38','160','114','89','78','59','48','40','35','30','27','24','22']];
            for (let row of majorData) { html += '<tr style="color: #00FF99;"><td style="border: 1px solid rgba(0,255,153,0.3); padding: 2px; font-weight: bold;">'+row[0]+'</td>'; for (let i=1; i<row.length; i++) html += '<td style="border: 1px solid rgba(0,255,153,0.3); padding: 2px; text-align: center;">'+row[i]+'</td>'; html += '</tr>'; }
            html += '</tbody></table></div></div>';
            
            // Tableau III - Oxyg√®ne
            html += '<div id="tableau-iii" style="margin-bottom: 18px; background: rgba(255,0,255,0.08); padding: 10px; border-radius: 8px; border-left: 4px solid #FF00FF;"><h3 style="color: #FF00FF; margin-bottom: 10px; font-size: 12px;">üìä Tableau III - Oxyg√®ne Pur</h3><div style="font-size: 8px; color: #FFFFFF; margin-bottom: 8px;">Diminution azote par inhalation O‚ÇÇ en surface</div><div style="overflow-x: auto;"><table style="width: 100%; border-collapse: collapse; font-size: 7px;"><thead><tr style="background: #330033;"><th style="border: 1px solid #FF00FF; padding: 2px;">Groupe</th><th style="border: 1px solid #FF00FF; padding: 2px;">Eq.</th><th style="border: 1px solid #FF00FF; padding: 2px;">15min</th><th style="border: 1px solid #FF00FF; padding: 2px;">30min</th><th style="border: 1px solid #FF00FF; padding: 2px;">45min</th><th style="border: 1px solid #FF00FF; padding: 2px;">60min</th><th style="border: 1px solid #FF00FF; padding: 2px;">90min</th><th style="border: 1px solid #FF00FF; padding: 2px;">120min</th><th style="border: 1px solid #FF00FF; padding: 2px;">150min</th><th style="border: 1px solid #FF00FF; padding: 2px;">180min</th></tr></thead><tbody>';
            const oxygenData = [['A','0.84','0.80','-','-','-','-','-','-','-'],['B','0.89','0.85','0.82','0.79','-','-','-','-','-'],['E','1.02','0.98','0.94','0.90','0.86','0.82','0.80','-','-'],['I','1.20','1.15','1.10','1.05','1.01','0.97','0.93','0.89','0.85'],['M','1.38','1.32','1.27','1.21','1.16','1.11','1.06','1.02','0.98'],['P','1.51','1.45','1.38','1.33','1.27','1.22','1.16','1.11','1.07']];
            for (let row of oxygenData) { html += '<tr style="color: #FF00FF;"><td style="border: 1px solid rgba(255,0,255,0.3); padding: 2px; font-weight: bold;">'+row[0]+'</td>'; for (let i=1; i<row.length; i++) html += '<td style="border: 1px solid rgba(255,0,255,0.3); padding: 2px; text-align: center;">'+row[i]+'</td>'; html += '</tr>'; }
            html += '</tbody></table></div></div>';
            
            // Tableau IV - Remont√©e
            html += '<div id="tableau-iv" style="margin-bottom: 18px; background: rgba(255,100,100,0.08); padding: 10px; border-radius: 8px; border-left: 4px solid #FF6464;"><h3 style="color: #FF6464; margin-bottom: 10px; font-size: 12px;">üìä Tableau IV - Dur√©e Remont√©e</h3><div style="font-size: 8px; color: #FFFFFF; margin-bottom: 8px;">Remont√©e jusqu\'au premier palier + temps interpaliers (minutes)</div><div style="overflow-x: auto;"><table style="width: 100%; border-collapse: collapse; font-size: 7px;"><thead><tr style="background: #330000;"><th style="border: 1px solid #FF6464; padding: 2px;">Palier</th><th style="border: 1px solid #FF6464; padding: 2px;">6min</th><th style="border: 1px solid #FF6464; padding: 2px;">10min</th><th style="border: 1px solid #FF6464; padding: 2px;">15min</th><th style="border: 1px solid #FF6464; padding: 2px;">20min</th><th style="border: 1px solid #FF6464; padding: 2px;">30min</th><th style="border: 1px solid #FF6464; padding: 2px;">40min</th><th style="border: 1px solid #FF6464; padding: 2px;">50min</th><th style="border: 1px solid #FF6464; padding: 2px;">60min</th><th style="border: 1px solid #FF6464; padding: 2px;">90min</th></tr></thead><tbody>';
            const remData = [['Sans','1','1','1','2','2','3','4','4','5'],['3m','1','1','2','2','3','4','4','5','5'],['6m','2','2','2','3','3','4','4','5','5'],['9m','2','2','2','3','3','4','5','5','6'],['12m','3','3','3','3','4','5','5','6','6'],['15m','3','3','3','4','4','5','5','6','6']];
            for (let row of remData) { html += '<tr style="color: #FF6464;"><td style="border: 1px solid rgba(255,100,100,0.3); padding: 2px; font-weight: bold;">'+row[0]+'</td>'; for (let i=1; i<row.length; i++) html += '<td style="border: 1px solid rgba(255,100,100,0.3); padding: 2px; text-align: center;">'+row[i]+'</td>'; html += '</tr>'; }
            html += '</tbody></table></div></div>';
            
            html += '<div style="color: #00ffff; text-align: center; padding: 15px; border-top: 2px solid #00ffff; margin-top: 15px; font-size: 11px;"><strong>‚úì TOTAL: ' + totalRows + ' LIGNES | + 4 TABLEAUX AUXILIAIRES</strong></div></div>';
            
            // Wrapper qui contient menu + splitter + contenu
            container.innerHTML = '<div id="tab2-wrapper">' + menuHtml + '<div id="tab2-splitter"></div>' + html + '</div>';
            
            // Initialiser le splitter pour PC
            if (window.innerWidth >= 1024) {
                const splitter = document.getElementById('tab2-splitter');
                if (splitter) {
                    splitter.addEventListener('mousedown', startTab2Drag);
                    splitter.addEventListener('touchstart', startTab2Drag, false);
                }
            }
        }
        
        let isTab2Dragging = false;
        function startTab2Drag(e) { isTab2Dragging = true; if (e.preventDefault) e.preventDefault(); }
        document.addEventListener('mousemove', moveTab2Drag);
        document.addEventListener('touchmove', moveTab2Drag, false);
        document.addEventListener('mouseup', () => { isTab2Dragging = false; });
        document.addEventListener('touchend', () => { isTab2Dragging = false; }, false);
        
        function moveTab2Drag(e) {
            if (!isTab2Dragging) return;
            const wrapper = document.getElementById('tab2-wrapper');
            const menu = document.getElementById('tab2-menu');
            const content = document.getElementById('tab2-content');
            if (!wrapper || !menu || !content) return;
            
            const rect = wrapper.getBoundingClientRect();
            const clientX = e.clientX || (e.touches ? e.touches[0].clientX : 0);
            const newWidth = clientX - rect.left;
            
            if (newWidth > 80 && newWidth < rect.width * 0.6) {
                menu.style.width = newWidth + 'px';
                if (chart1) chart1.resize();
            }
        }

        function updateSlider(slider) {
            const valSpan = document.getElementById(slider.id + '-val');
            if (valSpan) {
                let unit = ' m';
                if (slider.id.includes('time')) {
                    valSpan.textContent = minToHHMM(parseInt(slider.value));
                } else {
                    valSpan.textContent = slider.value + unit;
                }
            }
        }

        function startDrag(e) { isDraggingSplitter = true; document.body.style.userSelect = 'none'; if (e.preventDefault) e.preventDefault(); }
        function moveDrag(e) {
            if (!isDraggingSplitter) return;
            e.preventDefault?.();
            const contentWrapper = document.querySelector('.content-wrapper');
            const leftPanel = document.querySelector('.left-panel');
            const rightPanel = document.getElementById('rightPanel');
            const wrapperRect = contentWrapper.getBoundingClientRect();
            const isMobile = window.innerWidth < 1024;
            let clientY = e.clientY || (e.touches ? e.touches[0].clientY : 0);
            let clientX = e.clientX || (e.touches ? e.touches[0].clientX : 0);
            if (isMobile) {
                const newTopHeight = clientY - wrapperRect.top;
                const totalHeight = wrapperRect.height;
                if (newTopHeight > 80 && newTopHeight < totalHeight * 0.7) {
                    const graphHeight = totalHeight - newTopHeight - 8;
                    leftPanel.style.flex = `0 0 ${newTopHeight}px`;
                    rightPanel.style.flex = `0 0 ${graphHeight}px`;
                    if (chart1) chart1.resize();
                }
            } else {
                const newLeftWidth = clientX - wrapperRect.left;
                const totalWidth = wrapperRect.width;
                if (newLeftWidth > 200 && newLeftWidth < totalWidth * 0.6) {
                    const graphWidth = totalWidth - newLeftWidth - 6;
                    leftPanel.style.flex = `0 0 ${newLeftWidth}px`;
                    rightPanel.style.flex = `0 0 ${graphWidth}px`;
                    if (chart1) chart1.resize();
                }
            }
        }
        function stopDrag() { isDraggingSplitter = false; document.body.style.userSelect = 'auto'; }
        
        function downloadApp() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'MN90Mobile-DecompDiver.html';
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }
        
        function showDisclaimer() {
            const modal = document.getElementById('disclaimer-modal');
            if (modal) modal.style.display = 'flex';
        }
        
        function closeDisclaimer() {
            const modal = document.getElementById('disclaimer-modal');
            if (modal) {
                modal.style.display = 'none';
                // Restaurer le scroll du body
                document.body.style.overflow = 'auto';
            }
        }
        
        // Afficher le disclaimer au chargement - TOUJOURS
        document.addEventListener('DOMContentLoaded', () => {
            const modal = document.getElementById('disclaimer-modal');
            if (modal) {
                modal.style.display = 'flex !important';
                modal.style.visibility = 'visible';
                // Bloquer le scroll du body
                document.body.style.overflow = 'hidden';
            }
        });
        
        // S'assurer que le disclaimer est visible au chargement initial
        window.addEventListener('load', () => {
            const modal = document.getElementById('disclaimer-modal');
            if (modal) {
                modal.style.display = 'flex !important';
                modal.style.visibility = 'visible';
                document.body.style.overflow = 'hidden';
            }
        });
        
        window.addEventListener('resize', () => { if (chart1) chart1.resize(); });
        
        document.addEventListener('DOMContentLoaded', () => { 
            // Initialiser les event listeners
            const splitter = document.getElementById('splitter');
            if (splitter) {
                splitter.addEventListener('mousedown', startDrag);
                splitter.addEventListener('touchstart', startDrag, false);
            }
            document.addEventListener('mousemove', moveDrag);
            document.addEventListener('touchmove', moveDrag, false);
            document.addEventListener('mouseup', stopDrag);
            document.addEventListener('touchend', stopDrag, false);
            
            // Initialiser les onglets
            switchTab(0);
            document.getElementById('time1-val').textContent = minToHHMM(20);
            calculate();
        });
    </script>
    <style>
        /* ANIMATIONS AQUATIQUES */
        @keyframes float {
            0%, 100% { transform: translateY(0px) translateX(0px); opacity: 0.6; }
            50% { transform: translateY(-20px) translateX(10px); opacity: 0.8; }
        }
        @keyframes bubble-rise {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-100vh) scale(0.3); opacity: 0; }
        }
        @keyframes shark-swim {
            0% { transform: translateX(-100%) scaleX(1); }
            50% { transform: translateX(50vw) scaleX(1); }
            100% { transform: translateX(100vw) scaleX(-1); }
        }
        @keyframes crab-walk {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(30px) rotate(-5deg); }
            50% { transform: translateX(0) rotate(0deg); }
            75% { transform: translateX(-30px) rotate(5deg); }
        }
        
        .aquatic-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }
        
        .main-wrapper { z-index: 10; position: relative; }
        
        .aquatic-elem {
            position: absolute;
            font-size: 2em;
            animation: float 8s ease-in-out infinite;
        }
        
        .bubble {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8), rgba(0,200,255,0.2));
            animation: bubble-rise linear forwards;
            pointer-events: none;
        }
        
        .shark {
            position: absolute;
            font-size: 1.5em;
            animation: shark-swim 20s linear infinite;
            top: 20%;
        }
        
        .crab {
            position: absolute;
            font-size: 1.3em;
            animation: crab-walk 6s ease-in-out infinite;
            bottom: 15%;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(180deg, #001a33 0%, #003366 100%); color: #fff; height: 100vh; overflow: hidden; }
        .main-wrapper { height: 100vh; display: flex; flex-direction: column; }
        .header { background: rgba(0,102,204,0.95); padding: 10px; text-align: center; flex-shrink: 0; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 8px rgba(0,0,0,0.3); }
        .tabs { display: flex; gap: 6px; background: rgba(0,51,102,0.8); padding: 6px; flex-shrink: 0; overflow-x: auto; }
        .tab-btn { padding: 6px 12px; cursor: pointer; border: 2px solid transparent; font-weight: 600; border-radius: 8px; background: rgba(0,153,255,0.2); color: #fff; font-size: 11px; white-space: nowrap; }
        .tab-btn.active { background: rgba(0,153,255,0.5); border-color: #00ffff; }
        .content-wrapper { display: flex; flex: 1; gap: 0; position: relative; min-height: 0; overflow: hidden; }
        @media (max-width: 1023px) { .content-wrapper { flex-direction: column; } }
        .left-panel { flex: 0 0 380px; overflow-y: auto; display: flex; flex-direction: column; gap: 6px; padding: 8px; }
        .left-panel.tab2-active { flex: 1; }
        @media (max-width: 1023px) { .left-panel { flex: 1; min-width: 100%; } }
        #tab2-left { overflow-y: auto !important; }
        .splitter { width: 100%; height: 8px; background: linear-gradient(180deg, rgba(0,255,255,0.3), rgba(0,255,255,0.6), rgba(0,255,255,0.3)); cursor: row-resize; flex-shrink: 0; user-select: none; }
        @media (min-width: 1024px) { .splitter { width: 6px; height: auto; background: linear-gradient(90deg, rgba(0,255,255,0.3), rgba(0,255,255,0.6), rgba(0,255,255,0.3)); cursor: col-resize; } }
        #rightPanel { flex: 1; display: flex; flex-direction: column; padding: 8px; min-height: 150px; overflow: hidden; }
        .section { background: rgba(255,255,255,0.1); border-radius: 12px; border: 1px solid rgba(255,255,255,0.1); padding: 10px; }
        .section-title { font-size: 12px; color: #00ffff; font-weight: bold; margin-bottom: 8px; text-transform: uppercase; }
        .explanation { font-size: 11px; color: #FFFFFF; margin-bottom: 12px; line-height: 1.4; }
        .slider-group { margin-bottom: 10px; }
        .slider-label { display: flex; justify-content: space-between; font-size: 10px; margin-bottom: 4px; }
        .slider-label span { color: #00ffff; font-weight: bold; }
        input[type="range"] { width: 100%; height: 6px; border-radius: 3px; background: rgba(255,255,255,0.2); outline: none; -webkit-appearance: none; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 16px; height: 16px; border-radius: 50%; background: #00ffff; cursor: pointer; box-shadow: 0 0 10px rgba(0,255,255,0.5); }
        input[type="range"]::-moz-range-thumb { width: 16px; height: 16px; border-radius: 50%; background: #00ffff; cursor: pointer; border: none; box-shadow: 0 0 10px rgba(0,255,255,0.5); }
        .result-box { background: rgba(0,200,255,0.15); padding: 8px; border-radius: 8px; border-left: 4px solid #00ffff; margin: 4px 0; font-size: 11px; }
        .result-value { color: #00ffff; font-size: 16px; font-weight: bold; margin-top: 3px; }
        .graph-container { background: rgba(0,0,0,0.5); border: 2px solid #00ffff; border-radius: 12px; padding: 10px; flex: 1; display: flex; flex-direction: column; overflow: hidden; }
        #profileCanvas { flex: 1; width: 100%; }
        button { padding: 8px 12px; background: rgba(0,200,255,0.3); border: 2px solid #00ccff; border-radius: 6px; color: #00ffff; cursor: pointer; font-size: 11px; font-weight: 600; width: 100%; }
        button:hover { background: rgba(0,200,255,0.5); }
        .warning-box { background: rgba(255,50,50,0.15); border-left: 4px solid #ff3333; padding: 8px; border-radius: 4px; margin: 8px 0; font-weight: bold; color: #ff6666; display: none; }
        @media (min-width: 1024px) {
            #tab2-wrapper { display: flex; height: 100%; gap: 0; }
            #tab2-menu { width: 150px; overflow-y: auto; flex-shrink: 0; background: rgba(0,50,100,0.3); padding: 10px; border: 1px solid #00ffff; display: grid; grid-template-columns: repeat(2, 1fr); gap: 4px; align-content: start; }
            #tab2-splitter { width: 6px; background: linear-gradient(90deg, rgba(0,255,255,0.3), rgba(0,255,255,0.6), rgba(0,255,255,0.3)); cursor: col-resize; flex-shrink: 0; user-select: none; }
            #tab2-content { flex: 1; overflow-y: auto; padding: 10px; }
        }
        @media (max-width: 1023px) {
            #tab2-wrapper { display: flex; flex-direction: column; height: 100%; gap: 0; }
            #tab2-menu { width: 100%; height: auto; max-height: 200px; overflow-y: auto; background: rgba(0,50,100,0.3); padding: 10px; border: 1px solid #00ffff; display: grid; grid-template-columns: repeat(5, 1fr); gap: 4px; align-content: start; }
            #tab2-splitter { display: none; }
            #tab2-content { flex: 1; overflow-y: auto; padding: 10px; }
        }
        #tab2-menu-title { grid-column: 1 / -1; color: #00ffff; font-size: 10px; font-weight: bold; margin-bottom: 4px; }
        #tab2-menu button { padding: 6px; background: rgba(0,200,255,0.2); border: 1px solid #00ffff; border-radius: 4px; color: #00ffff; cursor: pointer; font-size: 8px; font-weight: bold; transition: all 0.2s; font-family: inherit; }
        #tab2-menu button:hover { background: rgba(0,255,255,0.3); }
    </style>
</head>
<body>
    <div class="main-wrapper">
        <div class="header" style="position: relative;">
            <h1>ü§ø MN90Mobile</h1>
            <div style="font-size: 10px; margin-top: 5px;">
                <strong>Planificateur de Plongee / Calcul d'Autonomie et Tables MN90</strong> - Made with love by <a href="https://github.com/Soaresden" target="_blank" style="color: #00ffff; text-decoration: none;">Soaresden</a> ‚ô•ü´ß
            </div>
        </div>
        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab(0)" style="background: rgba(255,221,136,0.3); border-color: #FFDD88; color: #FFDD88;">üìä Planificateur de Plong√©e</button>
            <button class="tab-btn" onclick="switchTab(1)">ü´Å Autonomie</button>
            <button class="tab-btn" onclick="switchTab(2)">üìã Tables</button>
            <button onclick="window.location.href='dive.html'" style="background: rgba(0,200,255,0.2); border: 2px solid #00CCFF; color: #00FFFF; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: bold; transition: all 0.3s;" onmouseover="this.style.background='rgba(0,200,255,0.4)'" onmouseout="this.style.background='rgba(0,200,255,0.2)'">ü§ø Dive Game</button>
            <button onclick="downloadApp()" style="background: rgba(0,255,255,0.2); border: 2px solid #00FFFF; color: #00FFFF; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: bold; transition: all 0.3s;" onmouseover="this.style.background='rgba(0,255,255,0.4)'" onmouseout="this.style.background='rgba(0,255,255,0.2)'">‚¨áÔ∏è T√©l√©charger Offline</button>
        </div>
        <div class="content-wrapper">
            <div class="left-panel">
                <div id="tab0-left" style="display: flex; flex-direction: column; gap: 6px; width: 100%;">
                    <div class="section">
                        <div class="section-title" style="color: #FFDD88;">ü§ø 1E PLONG√âE</div>
                        <div class="explanation">Entrez votre profondeur max et temps au fond. Les paliers s'ajustent automatiquement.</div>
                        <div class="slider-group">
                            <div class="slider-label" style="color: #FFDD88;"><span>Profondeur max</span><span id="depth1-val" style="color: #FFDD88;">20 m</span></div>
                            <input type="range" id="depth1" min="6" max="65" value="20" oninput="updateSlider(this); calculate()">
                        </div>
                        <div class="slider-group">
                            <div class="slider-label" style="color: #FFDD88;"><span>Temps au fond</span><span id="time1-val" style="color: #FFDD88;">00:20</span></div>
                            <input type="range" id="time1" min="1" max="400" value="20" oninput="updateSlider(this); calculate()">
                        </div>
                        
                        <!-- R√âSULTATS 1E PLONG√âE - SECTION VISIBLE -->
                        <div style="background: rgba(20,20,20,0.8); padding: 10px; border-radius: 6px; margin: 10px 0; border: 2px solid #FFDD88; box-shadow: 0 0 15px rgba(255,221,136,0.2);">
                            <div style="font-size: 10px; color: #FFDD88; font-weight: bold; margin-bottom: 8px; text-align: center; text-transform: uppercase; letter-spacing: 1px;">üìä R√©sultats 1e Plong√©e</div>
                            
                            <!-- L√âGENDE DES PALIERS -->
                            <div style="background: rgba(0,0,0,0.5); padding: 6px; border-radius: 4px; margin-bottom: 8px; font-size: 8px; border-left: 2px solid #FFDD88; text-align: center;">
                                <div style="display: flex; flex-wrap: wrap; gap: 6px; justify-content: center;">
                                    <span style="color: #FF99FF; font-weight: bold;">‚ñ† P15</span>
                                    <span style="color: #00DDDD; font-weight: bold;">‚ñ† P12</span>
                                    <span style="color: #00FF88; font-weight: bold;">‚ñ† P9</span>
                                    <span style="color: #FFA500; font-weight: bold;">‚ñ† P6</span>
                                    <span style="color: #00FF99; font-weight: bold;">‚ñ† P3</span>
                                </div>
                            </div>
                            
                            <!-- PALIERS SUR UNE SEULE LIGNE -->
                            <div style="background: rgba(180,150,50,0.3); padding: 6px; border-radius: 4px; margin-bottom: 6px; font-size: 9px; border-left: 2px solid #FFDD88;">
                                <span style="color: #FFDD88; font-weight: bold;">Paliers:</span> <span id="paliers-line" style="color: #FFFF00; font-weight: bold;">--</span>
                            </div>
                            
                            <!-- TEMPS TOTAL -->
                            <div style="background: rgba(180,150,50,0.25); padding: 6px; border-radius: 4px; margin-bottom: 6px; text-align: center; border-left: 2px solid #FFDD88;">
                                <div style="color: #FFFFFF; font-size: 8px;">‚è±Ô∏è TOTAL</div>
                                <div style="color: #FFDD88; font-size: 16px; font-weight: bold;" id="total1">-- min</div>
                            </div>
                            
                            <!-- DTR ET GPS EN 2 BLOCS - SUPER VISIBLE -->
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                <div style="background: #554400; padding: 12px; border-radius: 6px; text-align: center; border: 2px solid #FFDD88; box-shadow: 0 0 15px rgba(255,221,136,0.6), inset 0 0 10px rgba(255,221,136,0.2);">
                                    <div style="color: #FFFFFF; font-size: 9px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px;">‚è±Ô∏è DTR</div>
                                    <div style="color: #FFDD88; font-size: 20px; font-weight: bold; text-shadow: 0 0 12px #FFDD88, 0 0 25px #FF9900;" id="dtr1">--</div>
                                </div>
                                <div style="background: #554400; padding: 12px; border-radius: 6px; text-align: center; border: 2px solid #FFDD88; box-shadow: 0 0 15px rgba(255,221,136,0.6), inset 0 0 10px rgba(255,221,136,0.2);">
                                    <div style="color: #FFFFFF; font-size: 9px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px;">üéØ GPS</div>
                                    <div style="color: #FFDD88; font-size: 20px; font-weight: bold; text-shadow: 0 0 12px #FFDD88, 0 0 25px #FF9900;" id="gps1">--</div>
                                </div>
                            </div>
                            <div id="warning1" class="warning-box" style="margin-top: 6px;"></div>
                        </div>
                        
                        <!-- 2E PLONG√âE -->
                        <div style="background: rgba(180,120,220,0.07); padding: 10px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #BB88EE;">
                            <div style="font-size: 11px; color: #BB88EE; font-weight: bold; margin-bottom: 8px; text-transform: uppercase;">üîÑ 2E PLONG√âE</div>
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 10px; flex: 1;">
                                    <input type="checkbox" id="dive2-checkbox" onchange="calculate()" style="width: 18px; height: 18px; cursor: pointer;">
                                    <span style="color: #BB88EE; font-weight: bold;">Effectuer une 2e plong√©e</span>
                                </label>
                                <label id="view-toggle-label-menu" style="display: none; font-size: 10px; color: #00FFFF; cursor: pointer; user-select: none; gap: 4px; align-items: center; background: rgba(0,200,255,0.15); padding: 4px 8px; border-radius: 4px;">
                                    <input type="checkbox" id="view-toggle" onchange="switchDiveView()" style="cursor: pointer;">
                                    <span id="toggle-text-menu">üìä Superpos√©</span>
                                </label>
                            </div>
                            <div id="dive2-options" style="display: none;">
                                <div class="slider-group">
                                    <div class="slider-label"><span>Intervalle surface (min)</span><span id="dive2-interval-val">60 min</span></div>
                                    <input type="range" id="dive2-interval" min="10" max="480" value="60" oninput="updateSlider(this); calculate()" style="width: 100%;">
                                </div>
                                <div class="slider-group">
                                    <div class="slider-label"><span>Profondeur 2e plong√©e</span><span id="dive2-depth-val">20 m</span></div>
                                    <input type="range" id="dive2-depth" min="6" max="65" value="20" oninput="updateSlider(this); calculate()" style="width: 100%;">
                                </div>
                                <div class="slider-group">
                                    <div class="slider-label"><span>Dur√©e au fond (2e plong√©e)</span><span id="dive2-time-val">00:20</span></div>
                                    <input type="range" id="dive2-time" min="1" max="400" value="20" oninput="updateSlider(this); calculate()" style="width: 100%;">
                                </div>
                                
                                <!-- R√âSULTATS 2E PLONG√âE - SECTION VISIBLE -->
                                <div style="background: rgba(20,20,20,0.8); padding: 10px; border-radius: 6px; margin-top: 10px; border: 2px solid #BB88EE; box-shadow: 0 0 15px rgba(187,136,238,0.15);">
                                    <div style="font-size: 10px; color: #BB88EE; font-weight: bold; margin-bottom: 8px; text-transform: uppercase; text-align: center; letter-spacing: 1px;">üìä R√©sultats 2e Plong√©e</div>
                                    
                                    <!-- L√âGENDE DES PALIERS 2E PLONG√âE -->
                                    <div style="background: rgba(0,0,0,0.5); padding: 6px; border-radius: 4px; margin-bottom: 8px; font-size: 8px; border-left: 2px solid #BB88EE; text-align: center;">
                                        <div style="display: flex; flex-wrap: wrap; gap: 6px; justify-content: center;">
                                            <span style="color: #FF99FF; font-weight: bold;">‚ñ† P15</span>
                                            <span style="color: #00DDDD; font-weight: bold;">‚ñ† P12</span>
                                            <span style="color: #00FF88; font-weight: bold;">‚ñ† P9</span>
                                            <span style="color: #FFA500; font-weight: bold;">‚ñ† P6</span>
                                            <span style="color: #00FF99; font-weight: bold;">‚ñ† P3</span>
                                        </div>
                                    </div>
                                    
                                    <!-- PALIERS 2E PLONG√âE -->
                                    <div style="background: rgba(100,50,150,0.3); padding: 6px; border-radius: 4px; margin-bottom: 8px; font-size: 9px; border-left: 2px solid #BB88EE;">
                                        <span style="color: #BB88EE; font-weight: bold;">Paliers:</span> <span id="paliers-line2" style="color: #FFFF00; font-weight: bold;">--</span>
                                    </div>
                                    
                                    <!-- DTR ET GPS 2E PLONG√âE -->
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                                        <div style="background: #330044; padding: 8px; border-radius: 6px; text-align: center; border: 2px solid #BB88EE; box-shadow: 0 0 12px rgba(187,136,238,0.5), inset 0 0 8px rgba(187,136,238,0.15);">
                                            <div style="color: #FFFFFF; font-size: 8px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px;">‚è±Ô∏è DTR</div>
                                            <div style="color: #EE99FF; font-size: 16px; font-weight: bold; text-shadow: 0 0 10px #BB88EE, 0 0 20px #FF99FF;" id="dtr2">--</div>
                                        </div>
                                        <div style="background: #330044; padding: 8px; border-radius: 6px; text-align: center; border: 2px solid #BB88EE; box-shadow: 0 0 12px rgba(187,136,238,0.5), inset 0 0 8px rgba(187,136,238,0.15);">
                                            <div style="color: #FFFFFF; font-size: 8px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px;">üéØ GPS</div>
                                            <div style="color: #EE99FF; font-size: 16px; font-weight: bold; text-shadow: 0 0 10px #BB88EE, 0 0 20px #FF99FF;" id="gps2">--</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div id="tab1-left" style="display: none; flex-direction: column; gap: 6px; width: 100%;">
                    <div class="section">
                        <div class="section-title">ü´Å AUTONOMIE - CALCUL DE PLONG√âE</div>
                        <div class="explanation">Ajustez les sliders pour la 1√®re courbe, puis utilisez +/- pour les autres.</div>
                        
                        <!-- COURBE 1 (SLIDERS) -->
                        <div style="background: rgba(255,221,136,0.12); padding: 10px; border-radius: 8px; border: 2px solid #FFDD88; border-left: 4px solid #FFDD88; margin-bottom: 10px; box-shadow: 0 0 8px rgba(255,221,136,0.2);">
                            <div style="color: #FFDD88; font-weight: bold; margin-bottom: 10px; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px;">‚óÜ C1 - Courbe Jaune</div>
                            
                            <div class="slider-group">
                                <div class="slider-label"><span style="color: #FFFFFF; font-size: 10px;">Profondeur</span><span id="aut1-prof-val" style="color: #FFDD88; font-weight: bold;">20 m</span></div>
                                <input type="range" id="aut1-prof" min="6" max="60" value="20" oninput="updateSlider(this); drawAutonomyChart()">
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label"><span style="color: #FFFFFF; font-size: 10px;">Conso. Moy.</span><span id="aut1-conso-val" style="color: #FFDD88; font-weight: bold;">15 L/min</span></div>
                                <input type="range" id="aut1-conso" min="5" max="40" value="15" oninput="updateAutSlider(this); drawAutonomyChart()" style="width: 100%;">
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label"><span style="color: #FFFFFF; font-size: 10px;">Volume</span><span id="aut1-vol-val" style="color: #FFDD88; font-weight: bold;">12 L</span></div>
                                <input type="range" id="aut1-vol" min="3" max="20" value="12" oninput="updateAutSlider(this); drawAutonomyChart()" style="width: 100%;">
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label"><span style="color: #FFFFFF; font-size: 10px;">Press. Initiale</span><span id="aut1-press-val" style="color: #FFDD88; font-weight: bold;">200 bar</span></div>
                                <input type="range" id="aut1-press" min="100" max="300" value="200" oninput="updateAutSlider(this); drawAutonomyChart()" style="width: 100%;">
                            </div>
                            
                            <div class="slider-group">
                                <div class="slider-label"><span style="color: #FFFFFF; font-size: 10px;">Press. S√©curit√©</span><span id="aut1-safety-val" style="color: #FFDD88; font-weight: bold;">50 bar</span></div>
                                <input type="range" id="aut1-safety" min="20" max="100" value="50" oninput="updateAutSlider(this); drawAutonomyChart()" style="width: 100%;">
                            </div>
                            
                            <div style="background: rgba(255,255,0,0.25); padding: 10px; border-radius: 6px; margin-top: 8px; border: 2px solid #FFFF00; box-shadow: 0 0 12px rgba(255,255,0,0.3);">
                                <div style="display: flex; justify-content: space-around; align-items: center;">
                                    <div style="text-align: center;">
                                        <div style="color: #00FF99; font-size: 9px; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: bold;">‚è±Ô∏è Max Fond</div>
                                        <div style="color: #00FF99; font-weight: bold; font-size: 18px; text-shadow: 0 0 8px rgba(0,255,153,0.6);" id="aut1-maxtime">--:--:--</div>
                                    </div>
                                    <div style="width: 2px; height: 40px; background: rgba(255,255,0,0.3);"></div>
                                    <div style="text-align: center;">
                                        <div style="color: #00FF99; font-size: 9px; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: bold;">üìä Dur√©e Totale</div>
                                        <div style="color: #00FF99; font-weight: bold; font-size: 18px; text-shadow: 0 0 8px rgba(0,255,153,0.6);" id="aut1-totaltime">--:--:--</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- CALCUL AUTONOMIE -->
                            <div style="background: rgba(0,0,0,0.2); padding: 6px; border-radius: 4px; margin-top: 8px; font-family: 'Courier New', monospace; font-size: 9px; color: #FFFF00; line-height: 1.6;">
                                <div><span id="aut1-calc-step1" style="color: #00FFFF;">150</span> bar √ó <span id="aut1-calc-step1b" style="color: #00FFFF;">12</span> L = <span id="aut1-calc-result1">1800</span> L</div>
                                <div><span id="aut1-calc-step2">1800</span> L √∑ <span id="aut1-calc-step2b">15</span> L/min = <span id="aut1-calc-result2" style="color: #00FF99;">120</span> min</div>
                            </div>
                        </div>
                        
                        <!-- COURBES 2, 3, 4 (BOUTONS +/-) -->
                        <div id="aut-other-curves" style="display: grid; grid-template-columns: 1fr; gap: 8px;">
                            <!-- Courbe 2 -->
                            <div style="background: rgba(0,255,0,0.12); padding: 10px; border-radius: 8px; border: 2px solid #00FF00; border-left: 4px solid #00FF00; box-shadow: 0 0 8px rgba(0,255,0,0.2);">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin-bottom: 10px;">
                                    <input type="checkbox" id="aut2-enable" onchange="toggleCurveControls(2); drawAutonomyChart()" style="width: 16px; height: 16px;">
                                    <span style="color: #00FF00; font-weight: bold; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px;">‚óÜ C2 - Courbe Verte</span>
                                </label>
                                <div id="aut2-controls" style="display: none; font-size: 9px; grid-template-columns: 1fr 1fr; gap: 8px;">
                                    <div style="background: rgba(0,255,0,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #00FF00;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">PROFONDEUR</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut2-prof', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #00FF00; font-weight: bold; min-width: 32px;"><span id="aut2-prof-val">20</span>m</div>
                                            <button onclick="modifyParam('aut2-prof', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(0,255,0,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #00FF00;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">CONSOMMATION</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut2-conso', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #00FF00; font-weight: bold; min-width: 32px;"><span id="aut2-conso-val">15</span>L</div>
                                            <button onclick="modifyParam('aut2-conso', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(0,255,0,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #00FF00;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">VOLUME</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut2-vol', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #00FF00; font-weight: bold; min-width: 32px;"><span id="aut2-vol-val">12</span>L</div>
                                            <button onclick="modifyParam('aut2-vol', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(0,255,0,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #00FF00;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">PRESSION</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut2-press', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #00FF00; font-weight: bold; min-width: 32px;"><span id="aut2-press-val">200</span>b</div>
                                            <button onclick="modifyParam('aut2-press', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(0,255,0,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #00FF00; grid-column: 1 / -1;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">S√âCURIT√â</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut2-safety', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #00FF00; font-weight: bold; min-width: 32px;"><span id="aut2-safety-val">50</span>b</div>
                                            <button onclick="modifyParam('aut2-safety', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(0,255,0,0.25); padding: 10px; border-radius: 6px; margin-top: 4px; border: 2px solid #00FF00; box-shadow: 0 0 12px rgba(0,255,0,0.3); grid-column: 1 / -1;">
                                        <div style="display: flex; justify-content: space-around; align-items: center;">
                                            <div style="text-align: center;">
                                                <div style="color: #AAAAAA; font-size: 9px; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px;">‚è±Ô∏è Max Fond</div>
                                                <div style="color: #00FF99; font-weight: bold; font-size: 18px; text-shadow: 0 0 8px rgba(0,255,153,0.6);" id="aut2-maxtime">--:--:--</div>
                                            </div>
                                            <div style="width: 2px; height: 40px; background: rgba(0,255,0,0.3);"></div>
                                            <div style="text-align: center;">
                                                <div style="color: #AAAAAA; font-size: 9px; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px;">üìä Dur√©e Totale</div>
                                                <div style="color: #00FF99; font-weight: bold; font-size: 18px; text-shadow: 0 0 8px rgba(0,255,153,0.6);" id="aut2-totaltime">--:--:--</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- CALCUL AUTONOMIE C2 -->
                                    <div style="background: rgba(0,0,0,0.2); padding: 6px; border-radius: 4px; margin-top: 4px; font-family: 'Courier New', monospace; font-size: 9px; color: #00FF00; line-height: 1.6; grid-column: 1 / -1;">
                                        <div><span id="aut2-calc-step1" style="color: #00FFFF;">150</span> bar √ó <span id="aut2-calc-step1b" style="color: #00FFFF;">12</span> L = <span id="aut2-calc-result1">1800</span> L</div>
                                        <div><span id="aut2-calc-step2">1800</span> L √∑ <span id="aut2-calc-step2b">15</span> L/min = <span id="aut2-calc-result2" style="color: #00FF99;">120</span> min</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Courbe 3 -->
                            <div style="background: rgba(255,153,255,0.12); padding: 10px; border-radius: 8px; border: 2px solid #FF99FF; border-left: 4px solid #FF99FF; box-shadow: 0 0 8px rgba(255,153,255,0.2);">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin-bottom: 10px;">
                                    <input type="checkbox" id="aut3-enable" onchange="toggleCurveControls(3); drawAutonomyChart()" style="width: 16px; height: 16px;">
                                    <span style="color: #FF99FF; font-weight: bold; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px;">‚óÜ C3 - Courbe Magenta</span>
                                </label>
                                <div id="aut3-controls" style="display: none; font-size: 9px; grid-template-columns: 1fr 1fr; gap: 8px;">
                                    <div style="background: rgba(255,153,255,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #FF99FF;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">PROFONDEUR</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut3-prof', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #FF99FF; font-weight: bold; min-width: 32px;"><span id="aut3-prof-val">20</span>m</div>
                                            <button onclick="modifyParam('aut3-prof', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(255,153,255,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #FF99FF;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">CONSOMMATION</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut3-conso', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #FF99FF; font-weight: bold; min-width: 32px;"><span id="aut3-conso-val">15</span>L</div>
                                            <button onclick="modifyParam('aut3-conso', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(255,153,255,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #FF99FF;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">VOLUME</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut3-vol', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #FF99FF; font-weight: bold; min-width: 32px;"><span id="aut3-vol-val">12</span>L</div>
                                            <button onclick="modifyParam('aut3-vol', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(255,153,255,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #FF99FF;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">PRESSION</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut3-press', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #FF99FF; font-weight: bold; min-width: 32px;"><span id="aut3-press-val">200</span>b</div>
                                            <button onclick="modifyParam('aut3-press', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(255,153,255,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #FF99FF; grid-column: 1 / -1;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">S√âCURIT√â</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut3-safety', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #FF99FF; font-weight: bold; min-width: 32px;"><span id="aut3-safety-val">50</span>b</div>
                                            <button onclick="modifyParam('aut3-safety', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(255,153,255,0.25); padding: 10px; border-radius: 6px; margin-top: 4px; border: 2px solid #FF99FF; box-shadow: 0 0 12px rgba(255,153,255,0.3); grid-column: 1 / -1;">
                                        <div style="display: flex; justify-content: space-around; align-items: center;">
                                            <div style="text-align: center;">
                                                <div style="color: #AAAAAA; font-size: 9px; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px;">‚è±Ô∏è Max Fond</div>
                                                <div style="color: #00FF99; font-weight: bold; font-size: 18px; text-shadow: 0 0 8px rgba(0,255,153,0.6);" id="aut3-maxtime">--:--:--</div>
                                            </div>
                                            <div style="width: 2px; height: 40px; background: rgba(255,153,255,0.3);"></div>
                                            <div style="text-align: center;">
                                                <div style="color: #AAAAAA; font-size: 9px; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px;">üìä Dur√©e Totale</div>
                                                <div style="color: #00FF99; font-weight: bold; font-size: 18px; text-shadow: 0 0 8px rgba(0,255,153,0.6);" id="aut3-totaltime">--:--:--</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- CALCUL AUTONOMIE C3 -->
                                    <div style="background: rgba(0,0,0,0.2); padding: 6px; border-radius: 4px; margin-top: 4px; font-family: 'Courier New', monospace; font-size: 9px; color: #FF99FF; line-height: 1.6; grid-column: 1 / -1;">
                                        <div><span id="aut3-calc-step1" style="color: #00FFFF;">150</span> bar √ó <span id="aut3-calc-step1b" style="color: #00FFFF;">12</span> L = <span id="aut3-calc-result1">1800</span> L</div>
                                        <div><span id="aut3-calc-step2">1800</span> L √∑ <span id="aut3-calc-step2b">15</span> L/min = <span id="aut3-calc-result2" style="color: #00FF99;">120</span> min</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Courbe 4 -->
                            <div style="background: rgba(0,255,255,0.12); padding: 10px; border-radius: 8px; border: 2px solid #00FFFF; border-left: 4px solid #00FFFF; box-shadow: 0 0 8px rgba(0,255,255,0.2);">
                                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin-bottom: 10px;">
                                    <input type="checkbox" id="aut4-enable" onchange="toggleCurveControls(4); drawAutonomyChart()" style="width: 16px; height: 16px;">
                                    <span style="color: #00FFFF; font-weight: bold; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px;">‚óÜ C4 - Courbe Cyan</span>
                                </label>
                                <div id="aut4-controls" style="display: none; font-size: 9px; grid-template-columns: 1fr 1fr; gap: 8px;">
                                    <div style="background: rgba(0,255,255,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #00FFFF;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">PROFONDEUR</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut4-prof', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #00FFFF; font-weight: bold; min-width: 32px;"><span id="aut4-prof-val">20</span>m</div>
                                            <button onclick="modifyParam('aut4-prof', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(0,255,255,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #00FFFF;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">CONSOMMATION</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut4-conso', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #00FFFF; font-weight: bold; min-width: 32px;"><span id="aut4-conso-val">15</span>L</div>
                                            <button onclick="modifyParam('aut4-conso', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(0,255,255,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #00FFFF;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">VOLUME</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut4-vol', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #00FFFF; font-weight: bold; min-width: 32px;"><span id="aut4-vol-val">12</span>L</div>
                                            <button onclick="modifyParam('aut4-vol', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(0,255,255,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #00FFFF;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">PRESSION</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut4-press', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #00FFFF; font-weight: bold; min-width: 32px;"><span id="aut4-press-val">200</span>b</div>
                                            <button onclick="modifyParam('aut4-press', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(0,255,255,0.08); padding: 8px; border-radius: 6px; border-left: 3px solid #00FFFF; grid-column: 1 / -1;">
                                        <div style="color: #AAAAAA; font-size: 8px; margin-bottom: 4px;">S√âCURIT√â</div>
                                        <div style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                                            <button onclick="modifyParam('aut4-safety', -1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">‚àí</button>
                                            <div style="text-align: center; color: #00FFFF; font-weight: bold; min-width: 32px;"><span id="aut4-safety-val">50</span>b</div>
                                            <button onclick="modifyParam('aut4-safety', 1)" style="flex: 0 0 24px; padding: 4px 0; font-size: 10px;">+</button>
                                        </div>
                                    </div>
                                    <div style="background: rgba(0,255,255,0.25); padding: 10px; border-radius: 6px; margin-top: 4px; border: 2px solid #00FFFF; box-shadow: 0 0 12px rgba(0,255,255,0.3); grid-column: 1 / -1;">
                                        <div style="display: flex; justify-content: space-around; align-items: center;">
                                            <div style="text-align: center;">
                                                <div style="color: #AAAAAA; font-size: 9px; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px;">‚è±Ô∏è Max Fond</div>
                                                <div style="color: #00FF99; font-weight: bold; font-size: 18px; text-shadow: 0 0 8px rgba(0,255,153,0.6);" id="aut4-maxtime">--:--:--</div>
                                            </div>
                                            <div style="width: 2px; height: 40px; background: rgba(0,255,255,0.3);"></div>
                                            <div style="text-align: center;">
                                                <div style="color: #AAAAAA; font-size: 9px; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px;">üìä Dur√©e Totale</div>
                                                <div style="color: #00FF99; font-weight: bold; font-size: 18px; text-shadow: 0 0 8px rgba(0,255,153,0.6);" id="aut4-totaltime">--:--:--</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- CALCUL AUTONOMIE C4 -->
                                    <div style="background: rgba(0,0,0,0.2); padding: 6px; border-radius: 4px; margin-top: 4px; font-family: 'Courier New', monospace; font-size: 9px; color: #00FFFF; line-height: 1.6; grid-column: 1 / -1;">
                                        <div><span id="aut4-calc-step1" style="color: #00FFFF;">150</span> bar √ó <span id="aut4-calc-step1b" style="color: #00FFFF;">12</span> L = <span id="aut4-calc-result1">1800</span> L</div>
                                        <div><span id="aut4-calc-step2">1800</span> L √∑ <span id="aut4-calc-step2b">15</span> L/min = <span id="aut4-calc-result2" style="color: #00FF99;">120</span> min</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="tab2-left" style="display: none; flex-direction: column; gap: 6px; width: 100%;">
                </div>
            </div>
            <div class="splitter" id="splitter"></div>
            <div class="right-panel" id="rightPanel">
                <div class="graph-container" style="padding-top: 20px; padding-bottom: 25px;">
                    <div style="margin-bottom: 12px; display: flex; justify-content: space-between; align-items: flex-start; gap: 15px; flex-wrap: wrap;">
                        <div>
                            <div style="color: #00ffff; font-weight: bold; font-size: 12px;" id="graph-title">Profil de Plong√©e</div>
                            <div style="font-size: 9px; color: #AAAAAA; margin-top: 3px;">
                                üü¢ P3 | üü† P6 | üü° P9 | üîµ P12 | üü£ P15
                            </div>
                        </div>
                        <div id="autonomy-legend" style="font-size: 10px; display: flex; gap: 8px; flex-wrap: wrap; justify-content: flex-end;"></div>
                    </div>
                    <canvas id="profileCanvas"></canvas>
                </div>
            </div>
        </div>
    </div>
    
    <!-- MODAL DISCLAIMER -->
    <div id="disclaimer-modal" style="display: flex !important; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 99999; justify-content: center; align-items: center; padding: 10px; overflow: hidden;">
        <!-- Emojis anim√©s en arri√®re plan -->
        <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; overflow: hidden;">
            <!-- Poissons -->
            <div style="position: absolute; top: 10%; left: 5%; font-size: 30px; animation: float 6s ease-in-out infinite;">üê†</div>
            <div style="position: absolute; top: 20%; right: 8%; font-size: 35px; animation: float 8s ease-in-out infinite 1s;">ü¶à</div>
            <div style="position: absolute; bottom: 15%; left: 10%; font-size: 28px; animation: float 7s ease-in-out infinite 0.5s;">ü¶Ä</div>
            <div style="position: absolute; top: 50%; right: 5%; font-size: 32px; animation: float 9s ease-in-out infinite 1.5s;">üêü</div>
            <div style="position: absolute; top: 65%; left: 15%; font-size: 26px; animation: float 7s ease-in-out infinite 2s;">üê†</div>
            <div style="position: absolute; top: 35%; left: 20%; font-size: 28px; animation: float 8s ease-in-out infinite 1s;">ü¶ë</div>
            
            <!-- Bulles -->
            <div style="position: absolute; top: 15%; left: 15%; font-size: 20px; animation: bubble-rise 4s ease-in infinite;">ü´ß</div>
            <div style="position: absolute; top: 25%; right: 15%; font-size: 16px; animation: bubble-rise 5s ease-in infinite 0.5s;">ü´ß</div>
            <div style="position: absolute; top: 35%; left: 8%; font-size: 18px; animation: bubble-rise 6s ease-in infinite 1s;">ü´ß</div>
            <div style="position: absolute; top: 20%; left: 25%; font-size: 14px; animation: bubble-rise 5s ease-in infinite 0.3s;">ü´ß</div>
            <div style="position: absolute; top: 40%; right: 20%; font-size: 17px; animation: bubble-rise 6s ease-in infinite 1.2s;">ü´ß</div>
            <div style="position: absolute; top: 30%; right: 5%; font-size: 15px; animation: bubble-rise 5s ease-in infinite 0.7s;">ü´ß</div>
        </div>
        
        <div style="background: linear-gradient(135deg, #001a33 0%, #003366 100%); border: 3px solid #00FFFF; border-radius: 12px; padding: 25px; max-width: 500px; width: 100%; max-height: 95vh; overflow-y: auto; box-shadow: 0 0 60px rgba(0,255,255,0.6); position: relative; z-index: 10;">
            <div style="text-align: center; font-size: 35px; margin-bottom: 15px; animation: float 4s ease-in-out infinite;">
                ü§ø ‚ù§Ô∏è ü´ß
            </div>
            
            <h2 style="color: #FFDD88; margin-bottom: 15px; text-align: center; font-size: 18px;">PLONG√âE RESPONSABLE</h2>
            
            <div style="background: rgba(0,255,255,0.1); border-left: 4px solid #00FFFF; padding: 12px; margin-bottom: 15px; border-radius: 4px; font-size: 12px; line-height: 1.6;">
                <p style="color: #FFF; margin-bottom: 10px;">
                    üìö <strong>Source:</strong> Tables MN90-FFESSM
                </p>
                <p style="color: #FFF; margin-bottom: 10px;">
                    ‚úÖ <strong>Responsable:</strong> Directeur de Plong√©e uniquement
                </p>
                <p style="color: #FFF; margin-bottom: 10px;">
                    üèä <strong>Conditions:</strong> Bonne sant√©, certification, consignes
                </p>
                <p style="color: #FF6B6B; font-weight: bold;">
                    ‚ö†Ô∏è Accidents peuvent √™tre graves ou mortels
                </p>
            </div>
            
            <div style="background: rgba(0,255,0,0.1); border-left: 4px solid #00FF00; padding: 12px; border-radius: 4px; margin-bottom: 15px; text-align: center;">
                <p style="color: #00FF99; font-weight: bold; font-size: 13px; line-height: 1.6;">
                    üåä Prenez soin de vous<br>et des autres plongeurs ü´Ç<br><strong>Plongez en s√©curit√© ! ü§ø</strong>
                </p>
            </div>
            
            <div style="text-align: center; color: #00FFFF; font-style: italic; font-size: 11px; margin-bottom: 15px;">
                ‚Äî Cr√©√© par Denis S. üíô
            </div>
            
            <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                <button onclick="closeDisclaimer()" style="background: linear-gradient(135deg, #00FFFF, #00DDDD); color: #001a33; border: none; padding: 12px 25px; border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 14px; transition: all 0.3s; box-shadow: 0 0 15px rgba(0,255,255,0.4); flex: 1; min-width: 120px;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                    ‚úÖ Je Plonge Responsable ‚ù§Ô∏è
                </button>
                <button onclick="window.location.href='https://www.ffessm.fr'" style="background: rgba(0,255,255,0.1); color: #00FFFF; border: 2px solid #00FFFF; padding: 12px 25px; border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 14px; transition: all 0.3s; flex: 1; min-width: 100px;" onmouseover="this.style.background='rgba(0,255,255,0.2)'" onmouseout="this.style.background='rgba(0,255,255,0.1)'">
                    üìö FFESSM
                </button>
            </div>
        </div>
    </div>
    
    <!-- ANIMATIONS AQUATIQUES -->
    <div class="aquatic-background" id="aquatic-bg"></div>
    
    <script>
        // G√©n√©rer des bulles al√©atoires - VERSION OPTIMIS√âE
        function createBubbles() {
            const container = document.getElementById('aquatic-bg');
            if (!container) return;
            const bubbleCount = 10;  // Augment√© de 5 √† 10
            
            for (let i = 0; i < bubbleCount; i++) {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';
                const size = (Math.random() * 20 + 5);
                const left = (Math.random() * 100);
                const delay = (Math.random() * 6);
                const duration = (Math.random() * 10 + 10);
                
                bubble.style.width = size + 'px';
                bubble.style.height = size + 'px';
                bubble.style.left = left + '%';
                bubble.style.top = '100vh';
                bubble.style.animationDelay = delay + 's';
                bubble.style.animationDuration = duration + 's';
                bubble.style.opacity = '0.6';
                
                container.appendChild(bubble);
                
                setTimeout(() => {
                    bubble.remove();
                }, duration * 1000);
            }
        }
        
        // Cr√©er des bulles au d√©marrage, puis p√©riodiquement
        createBubbles();
        setInterval(() => {
            createBubbles();
        }, 8000);  // Nouvelle vague toutes les 8 secondes
        
        // Cr√©er les animaux - VERSION RICHE
        function createAnimals() {
            const container = document.getElementById('aquatic-bg');
            if (!container) return;
            
            // Un seul requin
            const shark = document.createElement('div');
            shark.className = 'shark';
            shark.innerHTML = 'ü¶à';
            shark.style.top = (Math.random() * 30) + '%';
            shark.style.left = '-10%';
            shark.style.opacity = '0.3';
            shark.style.fontSize = '1.2em';
            container.appendChild(shark);
            
            // 8 poissons (augment√© de 3)
            const fishes = ['üê†', 'üêü', 'ü¶ë'];
            for (let i = 0; i < 8; i++) {
                const fish = document.createElement('div');
                fish.className = 'aquatic-elem';
                fish.innerHTML = fishes[i % fishes.length];
                fish.style.left = (Math.random() * 100) + '%';
                fish.style.top = (Math.random() * 80) + '%';
                fish.style.animationDuration = (Math.random() * 15 + 12) + 's';
                fish.style.animationDelay = (Math.random() * 5) + 's';
                fish.style.opacity = '0.4';
                fish.style.fontSize = '0.9em';
                container.appendChild(fish);
            }
            
            // 2 crabes (au lieu de 1)
            for (let i = 0; i < 2; i++) {
                const crabs = document.createElement('div');
                crabs.className = 'crab';
                crabs.innerHTML = 'ü¶Ä';
                crabs.style.left = (Math.random() * 80 + 10) + '%';
                crabs.style.opacity = '0.3';
                crabs.style.fontSize = '1em';
                container.appendChild(crabs);
            }
        }
        
        // Initialiser les animations
        createAnimals();
    </script>